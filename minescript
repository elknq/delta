-- Wallhan Hub - iPhone Delta Version
local MASTER_KEY = "daddy" 
local VALID_KEYS = {["0x1xxxxjwj"] = true, ["iloveyoudaddywallhan"] = true}

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™
local SavedCheckpoint = nil
local WoodShieldActive = false
local WoodShieldAngle = 0
local _G_States = { ESP = false, Noclip = false, WoodShield = false, AntiFling = false }

-- ======= ÿØÿßŸÑÿ© ÿßŸÑÿ±ŸÇÿµÿßÿ™ =======
function OpenWallhanEmotes()
    local existing = game.CoreGui:FindFirstChild("WallhanEmotesMenu")
    if existing then existing:Destroy() end
    
    local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
    ScreenGui.Name = "WallhanEmotesMenu"
    
    local MainFrame = Instance.new("Frame", ScreenGui)
    MainFrame.Size = UDim2.new(0, 400, 0, 300)
    MainFrame.Position = UDim2.new(0.5, -200, 0.5, -150)
    MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    MainFrame.Active = true
    MainFrame.Draggable = true
    
    Instance.new("UICorner", MainFrame)
    
    local stroke = Instance.new("UIStroke", MainFrame)
    stroke.Color = Color3.fromRGB(200, 0, 0)
    stroke.Thickness = 2

    local Title = Instance.new("TextLabel", MainFrame)
    Title.Size = UDim2.new(1, 0, 0, 40)
    Title.Text = "üï∫ WALLHAN EMOTES"
    Title.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    Title.TextColor3 = Color3.new(1, 1, 1)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 16
    Instance.new("UICorner", Title)

    local Scroll = Instance.new("ScrollingFrame", MainFrame)
    Scroll.Size = UDim2.new(1, -10, 1, -50)
    Scroll.Position = UDim2.new(0, 5, 0, 45)
    Scroll.BackgroundTransparency = 1
    Scroll.ScrollBarThickness = 5

    local layout = Instance.new("UIGridLayout", Scroll)
    layout.CellSize = UDim2.new(0.45, 0, 0, 35)
    layout.CellPadding = UDim2.new(0.05, 0, 0.05, 0)

    local emotes = {
        {"Griddy", 9606471821}, {"Bugha", 7212401314}, {"Billy", 3338340150},
        {"Dancin", 5103431709}, {"Floss", 2825749343}, {"Take L", 2825729114},
        {"Default", 507771019}, {"Robot", 507771955}, {"Hype", 3696748324}
    }

    for _, emote in pairs(emotes) do
        local name, id = emote[1], emote[2]
        local btn = Instance.new("TextButton")
        btn.Parent = Scroll
        btn.Text = name
        btn.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 11
        Instance.new("UICorner", btn)
        
        btn.MouseButton1Click:Connect(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                local anim = Instance.new("Animation")
                anim.AnimationId = "rbxassetid://"..id
                local load = LocalPlayer.Character.Humanoid:LoadAnimation(anim)
                load:Play()
            end
        end)
    end

    local Close = Instance.new("TextButton", MainFrame)
    Close.Size = UDim2.new(0, 80, 0, 30)
    Close.Position = UDim2.new(0.5, -40, 1, -35)
    Close.Text = "CLOSE"
    Close.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    Close.TextColor3 = Color3.new(1, 1, 1)
    Close.Font = Enum.Font.GothamBold
    Close.TextSize = 14
    Instance.new("UICorner", Close)
    
    Close.MouseButton1Click:Connect(function() 
        ScreenGui:Destroy() 
    end)
    
    Scroll.CanvasSize = UDim2.new(0, 0, 0, math.ceil(#emotes/2) * 45)
end

-- ======= Wood Shield =======
function EnableWoodShield()
    WoodShieldActive = true
    WoodShieldAngle = 0
    
    local shieldConnection
    shieldConnection = RunService.Heartbeat:Connect(function()
        if not WoodShieldActive or not LocalPlayer.Character then 
            shieldConnection:Disconnect()
            return 
        end
        
        local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if not hrp then return end
        
        WoodShieldAngle = WoodShieldAngle + 0.04
        
        for _, v in pairs(workspace:GetDescendants()) do
            if v:IsA("BasePart") and not v.Anchored and not v:IsDescendantOf(LocalPlayer.Character) then
                if (v.Name:lower():find("wood") or v.Material == Enum.Material.Wood) and (v.Position - hrp.Position).Magnitude < 30 then
                    
                    for _, child in pairs(v:GetChildren()) do
                        if child:IsA("BodyMover") then child:Destroy() end
                    end
                    
                    local bodyPos = Instance.new("BodyPosition")
                    bodyPos.Parent = v
                    bodyPos.MaxForce = Vector3.new(20000, 20000, 20000)
                    bodyPos.P = 8000
                    
                    local radius = 5
                    local x = math.cos(WoodShieldAngle) * radius
                    local z = math.sin(WoodShieldAngle) * radius
                    
                    bodyPos.Position = hrp.Position + Vector3.new(x, 1, z)
                    v.CanCollide = false
                    
                    game:GetService("Debris"):AddItem(bodyPos, 0.3)
                end
            end
        end
    end)
end

function DisableWoodShield()
    WoodShieldActive = false
end

-- ======= Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑŸÖŸÅÿ™ÿßÿ≠ =======
local KeyGui = Instance.new("ScreenGui", game.CoreGui)
KeyGui.Name = "KeyGUI"

local KeyFrame = Instance.new("Frame", KeyGui)
KeyFrame.Size = UDim2.new(0, 280, 0, 160)
KeyFrame.Position = UDim2.new(0.5, -140, 0.5, -80)
KeyFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
KeyFrame.Active = true
KeyFrame.Draggable = true

Instance.new("UICorner", KeyFrame)

local stroke = Instance.new("UIStroke", KeyFrame)
stroke.Color = Color3.fromRGB(200, 0, 0)
stroke.Thickness = 2

local Title = Instance.new("TextLabel", KeyFrame)
Title.Size = UDim2.new(1, 0, 0, 35)
Title.Text = "üîê WALLHAN HUB"
Title.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
Title.TextColor3 = Color3.new(1, 1, 1)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 15
Instance.new("UICorner", Title)

local KeyInput = Instance.new("TextBox", KeyFrame)
KeyInput.Size = UDim2.new(0.8, 0, 0, 35)
KeyInput.Position = UDim2.new(0.1, 0, 0.3, 0)
KeyInput.PlaceholderText = "Enter key..."
KeyInput.Text = ""
KeyInput.TextColor3 = Color3.new(1, 1, 1)
KeyInput.BackgroundColor3 = Color3.fromRGB(30, 0, 0)
KeyInput.Font = Enum.Font.Gotham
KeyInput.TextSize = 14
Instance.new("UICorner", KeyInput)

local Submit = Instance.new("TextButton", KeyFrame)
Submit.Size = UDim2.new(0.8, 0, 0, 35)
Submit.Position = UDim2.new(0.1, 0, 0.65, 0)
Submit.Text = "ACTIVATE"
Submit.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
Submit.TextColor3 = Color3.new(1, 1, 1)
Submit.Font = Enum.Font.GothamBold
Submit.TextSize = 14
Instance.new("UICorner", Submit)

-- ======= ÿßŸÑŸàÿßÿ¨Ÿáÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© =======
function StartWallhan()
    KeyGui:Destroy()
    
    local sg = Instance.new("ScreenGui", game.CoreGui)
    sg.Name = "WallhanHub"
    
    local Main = Instance.new("Frame", sg)
    Main.Size = UDim2.new(0, 250, 0, 500)
    Main.Position = UDim2.new(1, -260, 0.5, -250)
    Main.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Main.BackgroundTransparency = 0.1
    Main.Active = true
    Main.Draggable = true
    
    Instance.new("UIStroke", Main).Color = Color3.fromRGB(150, 0, 0)
    Instance.new("UICorner", Main)

    local List = Instance.new("ScrollingFrame", Main)
    List.Size = UDim2.new(1, -10, 1, -60)
    List.Position = UDim2.new(0, 5, 0, 55)
    List.BackgroundTransparency = 1
    List.CanvasSize = UDim2.new(0, 0, 2.5, 0)
    List.ScrollBarThickness = 5
    
    local layout = Instance.new("UIListLayout", List)
    layout.Padding = UDim.new(0, 6)

    local function CreateButton(txt, cb)
        local b = Instance.new("TextButton", List)
        b.Size = UDim2.new(0.95, 0, 0, 38)
        b.BackgroundColor3 = Color3.fromRGB(130, 0, 0)
        b.Text = txt
        b.TextColor3 = Color3.new(1, 1, 1)
        b.Font = Enum.Font.GothamBold
        b.TextSize = 11
        Instance.new("UIStroke", b).Thickness = 1
        Instance.new("UICorner", b)
        b.MouseButton1Click:Connect(cb)
    end

    local function CreateToggle(txt, stateKey, enableFunc, disableFunc)
        local b = Instance.new("TextButton", List)
        b.Size = UDim2.new(0.95, 0, 0, 38)
        b.Font = Enum.Font.GothamBold
        b.TextSize = 11
        
        local function Upd()
            b.Text = txt .. (_G_States[stateKey] and " [ON]" or " [OFF]")
            b.BackgroundColor3 = _G_States[stateKey] and Color3.fromRGB(200, 0, 0) or Color3.fromRGB(45, 0, 0)
        end
        
        b.MouseButton1Click:Connect(function() 
            _G_States[stateKey] = not _G_States[stateKey] 
            if _G_States[stateKey] then
                if enableFunc then enableFunc() end
            else
                if disableFunc then disableFunc() end
            end
            Upd() 
        end)
        Upd()
        Instance.new("UICorner", b)
    end

    -- ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ±
    CreateButton("SET CHECKPOINT üö©", function()
        if LocalPlayer.Character and LocalPlayer.Character.HumanoidRootPart then
            SavedCheckpoint = LocalPlayer.Character.HumanoidRootPart.CFrame
            game.StarterGui:SetCore("SendNotification", {
                Title = "Wallhan",
                Text = "Checkpoint Saved",
                Duration = 2
            })
        end
    end)

    CreateButton("TP TO CHECKPOINT üåÄ", function()
        if SavedCheckpoint and LocalPlayer.Character and LocalPlayer.Character.HumanoidRootPart then
            LocalPlayer.Character.HumanoidRootPart.CFrame = SavedCheckpoint
        end
    end)

    CreateButton("RANDOM TP üé≤", function()
        local targets = {}
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= LocalPlayer and p.Character and p.Character.HumanoidRootPart then
                table.insert(targets, p)
            end
        end
        if #targets > 0 then
            local rP = targets[math.random(1, #targets)]
            LocalPlayer.Character:SetPrimaryPartCFrame(rP.Character.HumanoidRootPart.CFrame + Vector3.new(0, 5, 0))
        end
    end)

    CreateButton("EMOTES üï∫", OpenWallhanEmotes)

    CreateButton("TP TOOL üìç", function()
        local tp = Instance.new("Tool", LocalPlayer.Backpack)
        tp.Name = "TP Tool"
        tp.RequiresHandle = false
        tp.Activated:Connect(function() 
            if LocalPlayer.Character and Mouse.Hit then
                LocalPlayer.Character:MoveTo(Mouse.Hit.p + Vector3.new(0, 3, 0))
            end
        end)
    end)
    
    CreateToggle("ANTI-FLING üõ°Ô∏è", "AntiFling", 
        function()
            RunService.Heartbeat:Connect(function()
                if _G_States.AntiFling and LocalPlayer.Character then
                    local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                    if hrp and hrp.AssemblyLinearVelocity.Magnitude > 80 then
                        hrp.Velocity = Vector3.new(0, 0, 0)
                    end
                end
            end)
        end,
        function() end
    )
    
    CreateToggle("WOOD SHIELD üå™Ô∏è", "WoodShield", EnableWoodShield, DisableWoodShield)
    CreateToggle("ESP üëÅÔ∏è", "ESP")
    CreateToggle("NOCLIP üß±", "Noclip")

    -- Noclip
    RunService.Stepped:Connect(function()
        if _G_States.Noclip and LocalPlayer.Character then
            for _, v in pairs(LocalPlayer.Character:GetDescendants()) do
                if v:IsA("BasePart") then v.CanCollide = false end
            end
        end
    end)

    -- ÿ≤ÿ± ÿßŸÑÿ™ÿ®ÿØŸäŸÑ
    local ToggleBtn = Instance.new("TextButton", sg)
    ToggleBtn.Size = UDim2.new(0, 45, 0, 45)
    ToggleBtn.Position = UDim2.new(0, 15, 0, 15)
    ToggleBtn.BackgroundColor3 = Color3.new(0, 0, 0)
    ToggleBtn.Text = "W"
    ToggleBtn.TextColor3 = Color3.fromRGB(200, 0, 0)
    ToggleBtn.Font = Enum.Font.GothamBold
    ToggleBtn.TextSize = 22
    ToggleBtn.BackgroundTransparency = 0.2
    ToggleBtn.Draggable = true
    Instance.new("UIStroke", ToggleBtn).Color = Color3.fromRGB(200, 0, 0)
    Instance.new("UICorner", ToggleBtn).CornerRadius = UDim.new(1, 0)
    ToggleBtn.MouseButton1Click:Connect(function() 
        Main.Visible = not Main.Visible 
    end)
    
    game.StarterGui:SetCore("SendNotification", {
        Title = "WALLHAN HUB",
        Text = "Activated!",
        Duration = 3
    })
end

-- ======= ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿ≤ÿ± =======
Submit.MouseButton1Click:Connect(function()
    if KeyInput.Text == MASTER_KEY or VALID_KEYS[KeyInput.Text] then
        Submit.Text = "‚úÖ"
        Submit.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
        wait(0.3)
        StartWallhan()
    else
        Submit.Text = "‚ùå"
        Submit.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        wait(0.5)
        Submit.Text = "ACTIVATE"
        Submit.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
        KeyInput.Text = ""
    end
end)

-- ======= ÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ÿßŸÑÿ•ÿØÿÆÿßŸÑ =======
wait(0.5)
KeyInput:CaptureFocus()
