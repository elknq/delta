-- â–‘Wâ–‘Aâ–‘Lâ–‘Lâ–‘Hâ–‘Aâ–‘Nâ–‘ â–‘Hâ–‘Uâ–‘Bâ–‘ â–‘Vâ–‘2â–‘
-- ğŸ‘‘ PRIVATE VERSION - ALL RIGHTS RESERVED ğŸ‘‘
-- ğŸ“± Compatible with iPhone/Delta ğŸ“±

local MASTER_KEY = "daddy"
local VALID_KEYS = {["0x1xxxxjwj"] = true, ["iloveyoudaddywallhan"] = true}

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- Ù…ØªØºÙŠØ±Ø§Øª Ù…Ø­Ø³Ù†Ø©
local SavedCheckpoint = nil
local _G_States = { ESP = false, Noclip = false, WoodShield = false, AntiFling = false }
local ActiveWoodParts = {}
local LastWoodPositions = {}
local ShieldAngle = 0

-- ====================== ğŸ•º EMOTES SYSTEM (FIXED FE) ======================
local function OpenWallhanEmotes()
    local existing = game.CoreGui:FindFirstChild("WallhanEmotes")
    if existing then existing:Destroy() end
    
    local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
    ScreenGui.Name = "WallhanEmotes"
    
    local MainFrame = Instance.new("Frame", ScreenGui)
    MainFrame.Size = UDim2.new(0, 350, 0, 280)
    MainFrame.Position = UDim2.new(0.5, -175, 0.5, -140)
    MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    MainFrame.Active = true
    MainFrame.Draggable = true
    
    local corner = Instance.new("UICorner", MainFrame)
    corner.CornerRadius = UDim.new(0, 10)
    
    local stroke = Instance.new("UIStroke", MainFrame)
    stroke.Color = Color3.fromRGB(255, 50, 50)
    stroke.Thickness = 2

    local Title = Instance.new("TextLabel", MainFrame)
    Title.Size = UDim2.new(1, 0, 0, 40)
    Title.Text = "ğŸµ WALLHAN EMOTES ğŸµ"
    Title.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    Title.TextColor3 = Color3.new(1, 1, 1)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 16
    Instance.new("UICorner", Title)

    local Scroll = Instance.new("ScrollingFrame", MainFrame)
    Scroll.Size = UDim2.new(1, -10, 1, -50)
    Scroll.Position = UDim2.new(0, 5, 0, 45)
    Scroll.BackgroundTransparency = 1
    Scroll.ScrollBarThickness = 5

    local layout = Instance.new("UIGridLayout", Scroll)
    layout.CellSize = UDim2.new(0.45, 0, 0, 35)
    layout.CellPadding = UDim2.new(0.05, 0, 0.05, 0)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    -- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ù‚ØµØ§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø© ÙˆØ§Ù„Ø´ØºØ§Ù„Ø©
    local emotes = {
        {"Griddy", 656118852},      -- ğŸ•º Griddy
        {"Bugha", 6212546043},      -- ğŸ’ƒ Bugha
        {"Billy", 6863281352},       -- ğŸ‘ Billy
        {"Dancin", 6212546043},     -- ğŸ’ƒ Dancin
        {"Floss", 656118852},        -- ğŸ’ƒ Floss
        {"Take L", 656121766},       -- ğŸ‘ Take L
        {"Default", 507771019},      -- ğŸ’ƒ Default
        {"Robot", 507771955},        -- ğŸ¤– Robot
        {"Hype", 3696748324},        -- ğŸ‰ Hype
        {"Orange", 3696756105},      -- ğŸŠ Orange Justice
        {"Best Mate", 3696761332},   -- ğŸ‘¥ Best Mate
        {"L", 2825732154},           -- L Dance
        {"Zany", 6363537781},        -- ğŸ¤ª Zany
        {"Electro", 5917459364}      -- âš¡ Electro
    }

    for _, emote in pairs(emotes) do
        local name, id = emote[1], emote[2]
        local btn = Instance.new("TextButton")
        btn.Parent = Scroll
        btn.Text = name
        btn.BackgroundColor3 = Color3.fromRGB(50, 0, 0)
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 12
        Instance.new("UICorner", btn)
        
        btn.MouseButton1Click:Connect(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                local anim = Instance.new("Animation")
                anim.AnimationId = "rbxassetid://"..id
                local track = LocalPlayer.Character.Humanoid:LoadAnimation(anim)
                track:Play()
                
                -- Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                game:GetService("StarterGui"):SetCore("SendNotification", {
                    Title = "Wallhan Emotes",
                    Text = "Playing: "..name,
                    Duration = 2
                })
            end
        end)
        
        -- ØªØ£Ø«ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ±
        btn.MouseEnter:Connect(function()
            btn.BackgroundColor3 = Color3.fromRGB(100, 0, 0)
        end)
        btn.MouseLeave:Connect(function()
            btn.BackgroundColor3 = Color3.fromRGB(50, 0, 0)
        end)
    end

    local Close = Instance.new("TextButton", MainFrame)
    Close.Size = UDim2.new(0, 80, 0, 30)
    Close.Position = UDim2.new(0.5, -40, 1, -35)
    Close.Text = "âŒ CLOSE"
    Close.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    Close.TextColor3 = Color3.new(1, 1, 1)
    Close.Font = Enum.Font.GothamBold
    Close.TextSize = 14
    Instance.new("UICorner", Close)
    
    Close.MouseButton1Click:Connect(function() 
        ScreenGui:Destroy() 
    end)
end

-- ====================== ğŸŒªï¸ WOOD SHIELD SYSTEM (FIXED FOR ALL PLAYERS) ======================
local function EnableWoodShield()
    if _G_States.WoodShield then return end
    _G_States.WoodShield = true
    ShieldAngle = 0
    
    -- ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù‚Ø¯ÙŠÙ…
    for _, v in pairs(ActiveWoodParts) do
        if v then v:Destroy() end
    end
    ActiveWoodParts = {}
    
    -- Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø·Ø¹ Ø®Ø´Ø¨ÙŠØ© Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙŠØ±Ø§Ù‡Ø§ Ø§Ù„Ø¬Ù…ÙŠØ¹
    for i = 1, 6 do
        local wood = Instance.new("Part")
        wood.Name = "WallhanWood_"..i
        wood.Size = Vector3.new(3, 5, 0.8)
        wood.Material = Enum.Material.Wood
        wood.Color = Color3.fromRGB(102, 51, 0) -- Ù„ÙˆÙ† Ø®Ø´Ø¨ÙŠ Ø¯Ø§ÙƒÙ†
        wood.Anchored = false
        wood.CanCollide = true
        wood.Massless = false
        wood.Transparency = 0
        
        -- Ø¬Ø¹Ù„Ù‡Ø§ ÙÙŠ Workspace Ù„ÙŠØ±Ø§Ù‡Ø§ Ø§Ù„Ø¬Ù…ÙŠØ¹
        wood.Parent = workspace
        wood.Position = LocalPlayer.Character.HumanoidRootPart.Position
        
        -- ØªØ¯Ù…ÙŠØ±Ù‡Ø§ Ø¨Ø¹Ø¯ ÙØªØ±Ø© Ø¥Ø°Ø§ ÙÙ‚Ø¯Øª
        game:GetService("Debris"):AddItem(wood, 30)
        
        table.insert(ActiveWoodParts, wood)
    end
    
    -- Ø­Ø±ÙƒØ© Ø§Ù„Ø®Ø´Ø¨
    local shieldLoop
    shieldLoop = RunService.Heartbeat:Connect(function()
        if not _G_States.WoodShield or not LocalPlayer.Character then 
            shieldLoop:Disconnect()
            return 
        end
        
        local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if not hrp then return end
        
        ShieldAngle = ShieldAngle + 0.05
        
        for i, wood in pairs(ActiveWoodParts) do
            if wood and wood.Parent then
                local radians = ShieldAngle + (i * math.pi / 3)
                local radius = 7 + math.sin(ShieldAngle * 2 + i) * 1
                
                local targetPos = hrp.Position + Vector3.new(
                    math.cos(radians) * radius,
                    2 + math.sin(ShieldAngle * 3 + i) * 0.5,
                    math.sin(radians) * radius
                )
                
                -- Ø§Ø³ØªØ®Ø¯Ø§Ù… BodyPosition Ù„Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø³Ù„Ø³Ø©
                local bodyPos = wood:FindFirstChild("BodyPosition")
                if not bodyPos then
                    bodyPos = Instance.new("BodyPosition")
                    bodyPos.Parent = wood
                    bodyPos.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
                    bodyPos.P = 12000
                    bodyPos.D = 1000
                end
                
                bodyPos.Position = targetPos
                
                -- Ù‚ÙˆØ© Ø¯ÙØ§Ø¹ Ø¶Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
                for _, player in pairs(Players:GetPlayers()) do
                    if player ~= LocalPlayer and player.Character then
                        local enemyHrp = player.Character:FindFirstChild("HumanoidRootPart")
                        if enemyHrp and (enemyHrp.Position - wood.Position).Magnitude < 4 then
                            local pushDir = (enemyHrp.Position - wood.Position).Unit
                            enemyHrp.Velocity = enemyHrp.Velocity + (pushDir * 60) + Vector3.new(0, 15, 0)
                        end
                    end
                end
            end
        end
    end)
    
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "ğŸŒªï¸ WALLHAN SHIELD",
        Text = "ACTIVATED - All players can see it!",
        Duration = 3
    })
end

local function DisableWoodShield()
    _G_States.WoodShield = false
    
    task.wait(0.2)
    
    for _, wood in pairs(ActiveWoodParts) do
        if wood then
            wood:Destroy()
        end
    end
    ActiveWoodParts = {}
end

-- ====================== ğŸ‘ï¸ ESP SYSTEM (FIXED) ======================
local function EnableESP()
    _G_States.ESP = true
    
    local function CreateESP(player)
        if player == LocalPlayer or not player.Character then return end
        
        local char = player.Character
        local head = char:WaitForChild("Head", 2)
        if not head then return end
        
        -- Box ESP
        local box = Instance.new("BoxHandleAdornment")
        box.Name = "WallhanESP_Box"
        box.Adornee = char
        box.AlwaysOnTop = true
        box.Size = char:GetExtentsSize() + Vector3.new(0.1, 0.1, 0.1)
        box.Color3 = Color3.new(1, 0, 0)
        box.Transparency = 0.4
        box.ZIndex = 10
        box.Parent = char
        
        -- Name Tag
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "WallhanESP_Name"
        billboard.Size = UDim2.new(0, 200, 0, 50)
        billboard.AlwaysOnTop = true
        billboard.StudsOffset = Vector3.new(0, 3.5, 0)
        billboard.Adornee = head
        billboard.Parent = char
        
        local textLabel = Instance.new("TextLabel", billboard)
        textLabel.Size = UDim2.new(1, 0, 1, 0)
        textLabel.BackgroundTransparency = 1
        textLabel.Text = player.Name
        textLabel.TextColor3 = Color3.new(1, 0, 0)
        textLabel.TextStrokeTransparency = 0.5
        textLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
        textLabel.Font = Enum.Font.GothamBold
        textLabel.TextSize = 14
    end
    
    -- ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù…ÙŠØ¹
    for _, player in pairs(Players:GetPlayers()) do
        CreateESP(player)
    end
    
    -- Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø¬Ø¯Ø¯
    Players.PlayerAdded:Connect(CreateESP)
end

local function DisableESP()
    _G_States.ESP = false
    
    for _, player in pairs(Players:GetPlayers()) do
        if player.Character then
            local box = player.Character:FindFirstChild("WallhanESP_Box")
            local nameTag = player.Character:FindFirstChild("WallhanESP_Name")
            
            if box then box:Destroy() end
            if nameTag then nameTag:Destroy() end
        end
    end
end

-- ====================== ğŸ§± NOCLIP SYSTEM ======================
local function EnableNoclip()
    _G_States.Noclip = true
    
    local noclipLoop
    noclipLoop = RunService.Stepped:Connect(function()
        if not _G_States.Noclip or not LocalPlayer.Character then 
            noclipLoop:Disconnect()
            return 
        end
        
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end)
end

local function DisableNoclip()
    _G_States.Noclip = false
end

-- ====================== ğŸ›¡ï¸ ANTI-FLING SYSTEM ======================
local function EnableAntiFling()
    _G_States.AntiFling = true
    
    local antiFlingLoop
    antiFlingLoop = RunService.Heartbeat:Connect(function()
        if not _G_States.AntiFling or not LocalPlayer.Character then 
            antiFlingLoop:Disconnect()
            return 
        end
        
        local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if hrp then
            if hrp.AssemblyLinearVelocity.Magnitude > 100 then
                hrp.Velocity = hrp.Velocity * 0.3
            end
            
            if hrp.AssemblyAngularVelocity.Magnitude > 50 then
                hrp.RotVelocity = Vector3.new(0, 0, 0)
            end
        end
    end)
end

local function DisableAntiFling()
    _G_States.AntiFling = false
end

-- ====================== ğŸ˜ˆ TROLL FACE UI ======================
local function OpenTrollFaceUI()
    local existing = game.CoreGui:FindFirstChild("WallhanTrollUI")
    if existing then existing:Destroy() end
    
    local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
    ScreenGui.Name = "WallhanTrollUI"
    
    local TrollFrame = Instance.new("Frame", ScreenGui)
    TrollFrame.Size = UDim2.new(0, 250, 0, 320)
    TrollFrame.Position = UDim2.new(0.5, -125, 0.5, -160)
    TrollFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    TrollFrame.Active = true
    TrollFrame.Draggable = true
    
    Instance.new("UICorner", TrollFrame)
    
    local stroke = Instance.new("UIStroke", TrollFrame)
    stroke.Color = Color3.fromRGB(255, 255, 0)
    stroke.Thickness = 3

    -- Troll Face Image
    local TrollImage = Instance.new("ImageLabel", TrollFrame)
    TrollImage.Size = UDim2.new(1, -20, 0, 150)
    TrollImage.Position = UDim2.new(0, 10, 0, 10)
    TrollImage.BackgroundTransparency = 1
    TrollImage.Image = "rbxassetid://1260873262" -- Troll Face
    TrollImage.ScaleType = Enum.ScaleType.Fit

    local Title = Instance.new("TextLabel", TrollFrame)
    Title.Size = UDim2.new(1, 0, 0, 40)
    Title.Position = UDim2.new(0, 0, 0, 165)
    Title.Text = "ğŸ˜ˆ WALLHAN TROLL ğŸ˜ˆ"
    Title.BackgroundColor3 = Color3.fromRGB(255, 215, 0)
    Title.TextColor3 = Color3.new(0, 0, 0)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 16
    Instance.new("UICorner", Title)

    local ButtonFrame = Instance.new("Frame", TrollFrame)
    ButtonFrame.Size = UDim2.new(1, -20, 0, 100)
    ButtonFrame.Position = UDim2.new(0, 10, 0, 210)
    ButtonFrame.BackgroundTransparency = 1
    
    local layout = Instance.new("UIListLayout", ButtonFrame)
    layout.Padding = UDim.new(0, 8)
    
    local function CreateTrollButton(text, callback)
        local btn = Instance.new("TextButton", ButtonFrame)
        btn.Size = UDim2.new(1, 0, 0, 30)
        btn.Text = text
        btn.BackgroundColor3 = Color3.fromRGB(50, 50, 0)
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 12
        Instance.new("UICorner", btn)
        
        btn.MouseButton1Click:Connect(callback)
        
        return btn
    end
    
    -- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ±ÙˆÙŠÙ„
    CreateTrollButton("ğŸ”„ SPIN PLAYERS", function()
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character then
                local hrp = player.Character:FindFirstChild("HumanoidRootPart")
                if hrp then
                    hrp.RotVelocity = Vector3.new(0, 100, 0)
                end
            end
        end
    end)
    
    CreateTrollButton("ğŸˆ BALLOON PLAYERS", function()
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character then
                local hrp = player.Character:FindFirstChild("HumanoidRootPart")
                if hrp then
                    hrp.Velocity = hrp.Velocity + Vector3.new(0, 100, 0)
                end
            end
        end
    end)
    
    CreateTrollButton("ğŸŒ€ BLACK HOLE", function()
        local center = LocalPlayer.Character.HumanoidRootPart.Position
        
        for _, part in pairs(workspace:GetDescendants()) do
            if part:IsA("BasePart") and not part.Anchored and not part:IsDescendantOf(LocalPlayer.Character) then
                local dir = (center - part.Position).Unit
                part.Velocity = dir * 50
            end
        end
    end)

    local Close = Instance.new("TextButton", TrollFrame)
    Close.Size = UDim2.new(0, 80, 0, 30)
    Close.Position = UDim2.new(0.5, -40, 1, -35)
    Close.Text = "âŒ CLOSE"
    Close.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    Close.TextColor3 = Color3.new(1, 1, 1)
    Close.Font = Enum.Font.GothamBold
    Close.TextSize = 14
    Instance.new("UICorner", Close)
    
    Close.MouseButton1Click:Connect(function() 
        ScreenGui:Destroy() 
    end)
end

-- ====================== ğŸ” KEY GUI ======================
local KeyGui = Instance.new("ScreenGui", game.CoreGui)
KeyGui.Name = "WallhanKeyGUI"

local KeyFrame = Instance.new("Frame", KeyGui)
KeyFrame.Size = UDim2.new(0, 300, 0, 180)
KeyFrame.Position = UDim2.new(0.5, -150, 0.5, -90)
KeyFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
KeyFrame.Active = true
KeyFrame.Draggable = true

Instance.new("UICorner", KeyFrame)

local keyStroke = Instance.new("UIStroke", KeyFrame)
keyStroke.Color = Color3.fromRGB(255, 50, 50)
keyStroke.Thickness = 2

local Title = Instance.new("TextLabel", KeyFrame)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Text = "ğŸ” WALLHAN HUB V2 ğŸ”"
Title.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
Title.TextColor3 = Color3.new(1, 1, 1)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 16
Instance.new("UICorner", Title)

local KeyInput = Instance.new("TextBox", KeyFrame)
KeyInput.Size = UDim2.new(0.8, 0, 0, 35)
KeyInput.Position = UDim2.new(0.1, 0, 0.3, 0)
KeyInput.PlaceholderText = "Enter 'daddy'"
KeyInput.Text = ""
KeyInput.TextColor3 = Color3.new(1, 1, 1)
KeyInput.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
KeyInput.Font = Enum.Font.Gotham
KeyInput.TextSize = 14
Instance.new("UICorner", KeyInput)

local Submit = Instance.new("TextButton", KeyFrame)
Submit.Size = UDim2.new(0.8, 0, 0, 35)
Submit.Position = UDim2.new(0.1, 0, 0.65, 0)
Submit.Text = "ğŸ”“ ACTIVATE"
Submit.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
Submit.TextColor3 = Color3.new(1, 1, 1)
Submit.Font = Enum.Font.GothamBold
Submit.TextSize = 14
Instance.new("UICorner", Submit)

-- ====================== ğŸ® MAIN HUB UI ======================
local function StartWallhan()
    KeyGui:Destroy()
    
    local MainGui = Instance.new("ScreenGui", game.CoreGui)
    MainGui.Name = "WallhanHubV2"
    
    local MainFrame = Instance.new("Frame", MainGui)
    MainFrame.Size = UDim2.new(0, 280, 0, 520)
    MainFrame.Position = UDim2.new(1, -290, 0.5, -260)
    MainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    MainFrame.BackgroundTransparency = 0.05
    MainFrame.Active = true
    MainFrame.Draggable = true
    
    Instance.new("UICorner", MainFrame)
    
    local mainStroke = Instance.new("UIStroke", MainFrame)
    mainStroke.Color = Color3.fromRGB(255, 50, 50)
    mainStroke.Thickness = 2

    local Title = Instance.new("TextLabel", MainFrame)
    Title.Size = UDim2.new(1, 0, 0, 45)
    Title.Text = "ğŸ‘‘ WALLHAN HUB ğŸ‘‘"
    Title.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    Title.TextColor3 = Color3.new(1, 1, 1)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 18
    Instance.new("UICorner", Title)

    local List = Instance.new("ScrollingFrame", MainFrame)
    List.Size = UDim2.new(1, -10, 1, -110)
    List.Position = UDim2.new(0, 5, 0, 50)
    List.BackgroundTransparency = 1
    List.CanvasSize = UDim2.new(0, 0, 3, 0)
    List.ScrollBarThickness = 6
    
    local layout = Instance.new("UIListLayout", List)
    layout.Padding = UDim.new(0, 8)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    local function CreateHubButton(text, callback)
        local btn = Instance.new("TextButton", List)
        btn.Size = UDim2.new(0.95, 0, 0, 40)
        btn.Text = text
        btn.BackgroundColor3 = Color3.fromRGB(60, 0, 0)
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 12
        Instance.new("UICorner", btn)
        
        local btnStroke = Instance.new("UIStroke", btn)
        btnStroke.Color = Color3.fromRGB(100, 0, 0)
        btnStroke.Thickness = 1
        
        btn.MouseButton1Click:Connect(callback)
        
        -- ØªØ£Ø«ÙŠØ±Ø§Øª
        btn.MouseEnter:Connect(function()
            game:GetService("TweenService"):Create(btn, TweenInfo.new(0.2), {
                BackgroundColor3 = Color3.fromRGB(100, 0, 0)
            }):Play()
        end)
        
        btn.MouseLeave:Connect(function()
            game:GetService("TweenService"):Create(btn, TweenInfo.new(0.2), {
                BackgroundColor3 = Color3.fromRGB(60, 0, 0)
            }):Play()
        end)
        
        return btn
    end

    local function CreateHubToggle(text, stateKey, enableFunc, disableFunc)
        local btn = Instance.new("TextButton", List)
        btn.Size = UDim2.new(0.95, 0, 0, 40)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 12
        
        local function UpdateToggle()
            if _G_States[stateKey] then
                btn.Text = "âœ… " .. text .. " âœ…"
                btn.BackgroundColor3 = Color3.fromRGB(0, 60, 0)
            else
                btn.Text = "âŒ " .. text .. " âŒ"
                btn.BackgroundColor3 = Color3.fromRGB(60, 0, 0)
            end
        end
        
        btn.MouseButton1Click:Connect(function()
            _G_States[stateKey] = not _G_States[stateKey]
            
            if _G_States[stateKey] then
                if enableFunc then enableFunc() end
            else
                if disableFunc then disableFunc() end
            end
            
            UpdateToggle()
        end)
        
        UpdateToggle()
        Instance.new("UICorner", btn)
        
        return btn
    end

    -- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    CreateHubButton("ğŸ’¾ SAVE CHECKPOINT", function()
        if LocalPlayer.Character and LocalPlayer.Character.HumanoidRootPart then
            SavedCheckpoint = LocalPlayer.Character.HumanoidRootPart.CFrame
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Wallhan Hub",
                Text = "Checkpoint Saved! ğŸ’¾",
                Duration = 3
            })
        end
    end)

    CreateHubButton("ğŸŒ€ LOAD CHECKPOINT", function()
        if SavedCheckpoint and LocalPlayer.Character and LocalPlayer.Character.HumanoidRootPart then
            LocalPlayer.Character.HumanoidRootPart.CFrame = SavedCheckpoint
        end
    end)

    CreateHubButton("ğŸ² TELEPORT TO RANDOM", function()
        local targets = {}
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character and player.Character.HumanoidRootPart then
                table.insert(targets, player)
            end
        end
        
        if #targets > 0 then
            local target = targets[math.random(1, #targets)]
            LocalPlayer.Character:SetPrimaryPartCFrame(target.Character.HumanoidRootPart.CFrame)
        end
    end)

    CreateHubButton("ğŸ•º EMOTES MENU", OpenWallhanEmotes)
    
    CreateHubButton("ğŸ˜ˆ TROLL MENU", OpenTrollFaceUI)

    CreateHubButton("ğŸ“ WALLHAN TP TOOL", function()
        local tool = Instance.new("Tool", LocalPlayer.Backpack)
        tool.Name = "ğŸ“ Wallhan TP"
        tool.ToolTip = "Click to teleport"
        tool.RequiresHandle = false
        
        tool.Activated:Connect(function()
            if LocalPlayer.Character and Mouse.Hit then
                LocalPlayer.Character:MoveTo(Mouse.Hit.p + Vector3.new(0, 3, 0))
            end
        end)
        
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Wallhan Hub",
            Text = "TP Tool Added to Backpack!",
            Duration = 3
        })
    end)

    -- Ø§Ù„ØªÙ‚Ù„Ø¨Ø§Øª
    CreateHubToggle("ğŸŒªï¸ WOOD SHIELD", "WoodShield", EnableWoodShield, DisableWoodShield)
    CreateHubToggle("ğŸ›¡ï¸ ANTI-FLING", "AntiFling", EnableAntiFling, DisableAntiFling)
    CreateHubToggle("ğŸ‘ï¸ BOX ESP", "ESP", EnableESP, DisableESP)
    CreateHubToggle("ğŸ§± NOCLIP", "Noclip", EnableNoclip, DisableNoclip)

    -- Ø²Ø± Ø¥ØºÙ„Ø§Ù‚/ÙØªØ­ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    local ToggleBtn = Instance.new("TextButton", MainGui)
    ToggleBtn.Size = UDim2.new(0, 50, 0, 50)
    ToggleBtn.Position = UDim2.new(0, 20, 0.5, -25)
    ToggleBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    ToggleBtn.BackgroundTransparency = 0.2
    ToggleBtn.Text = "ğŸ‘‘"
    ToggleBtn.TextColor3 = Color3.fromRGB(255, 50, 50)
    ToggleBtn.Font = Enum.Font.GothamBold
    ToggleBtn.TextSize = 24
    ToggleBtn.Draggable = true
    
    Instance.new("UICorner", ToggleBtn).CornerRadius = UDim.new(1, 0)
    
    local toggleStroke = Instance.new("UIStroke", ToggleBtn)
    toggleStroke.Color = Color3.fromRGB(255, 50, 50)
    toggleStroke.Thickness = 2
    
    ToggleBtn.MouseButton1Click:Connect(function()
        MainFrame.Visible = not MainFrame.Visible
        ToggleBtn.Text = MainFrame.Visible and "ğŸ‘‘" or "ğŸ®"
    end)
    
    -- Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¨Ø¯Ø¡
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "ğŸ‘‘ WALLHAN HUB V2",
        Text = "PRIVATE VERSION ACTIVATED!",
        Duration = 5,
        Icon = "rbxassetid://445366433"
    })
    
    print("=================================")
    print("ğŸ‘‘ WALLHAN HUB V2 - PRIVATE")
    print("ğŸ‘‘ Developer: Wallhan")
    print("ğŸ“± Compatible: iPhone/Delta")
    print("âœ… All Rights Reserved")
    print("=================================")
end

-- ====================== ğŸš€ ACTIVATION ======================
Submit.MouseButton1Click:Connect(function()
    local key = KeyInput.Text
    
    if key == MASTER_KEY or VALID_KEYS[key] then
        Submit.Text = "âœ… SUCCESS"
        Submit.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
        
        task.wait(0.5)
        StartWallhan()
    else
        Submit.Text = "âŒ DENIED"
        Submit.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        KeyInput.Text = ""
        
        task.wait(0.8)
        Submit.Text = "ğŸ”“ ACTIVATE"
        Submit.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    end
end)

-- ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
task.wait(0.5)
KeyInput:CaptureFocus()

print("Wallhan Hub V2 Loaded - Waiting for key...")
