local MASTER_KEY = "daddy" 
local VALID_KEYS = {["0x1xxxxjwj"] = true, ["iloveyoudaddywallhan"] = true}

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- Ù…ØªØºÙŠØ±Ø§Øª Ù…Ø­Ø³Ù†Ø©
local SavedCheckpoint = nil
local WoodShieldActive = false
local WoodShieldAngle = 0
local WoodShieldConnection = nil
local ActiveWoodParts = {}
local LastWoodPositions = {} -- Ø­ÙØ¸ Ø¢Ø®Ø± Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø®Ø´Ø¨ Ù„ÙŠØ¹ÙˆØ¯ Ù„Ù‡Ø§

-- ========== Ø¥ØµÙ„Ø§Ø­ 1: Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ù‚ØµØ§Øª Ù…Ø¹ Ø²Ø± Ø¥ØºÙ„Ø§Ù‚ ÙŠØ¹Ù…Ù„ ==========
local function OpenWallhanEmotes()
    -- ØªØ¯Ù…ÙŠØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ø¥Ø°Ø§ Ù…ÙˆØ¬ÙˆØ¯Ø©
    local existingGui = game.CoreGui:FindFirstChild("WallhanEmotesMenu")
    if existingGui then existingGui:Destroy() end
    
    local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
    ScreenGui.Name = "WallhanEmotesMenu"
    ScreenGui.DisplayOrder = 999
    
    local MainFrame = Instance.new("Frame", ScreenGui)
    MainFrame.Size = UDim2.new(0, 400, 0, 320)
    MainFrame.Position = UDim2.new(0.5, -200, 0.5, -160)
    MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    MainFrame.Active = true
    MainFrame.Draggable = true
    Instance.new("UICorner", MainFrame)
    local stroke = Instance.new("UIStroke", MainFrame)
    stroke.Color = Color3.fromRGB(200, 0, 0)
    stroke.Thickness = 2

    local Title = Instance.new("TextLabel", MainFrame)
    Title.Size = UDim2.new(1, 0, 0, 45)
    Title.Text = "ğŸ•º WALLHAN EMOTES ğŸ•º"
    Title.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    Title.TextColor3 = Color3.new(1, 1, 1)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 18
    Instance.new("UICorner", Title)

    local Scroll = Instance.new("ScrollingFrame", MainFrame)
    Scroll.Size = UDim2.new(1, -10, 1, -60)
    Scroll.Position = UDim2.new(0, 5, 0, 50)
    Scroll.BackgroundTransparency = 1
    Scroll.ScrollBarThickness = 6
    Scroll.CanvasSize = UDim2.new(0, 0, 0, 0) -- Ø³ÙŠØªÙ… ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹

    local layout = Instance.new("UIListLayout", Scroll)
    layout.Padding = UDim.new(0, 8)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    -- Ù‚Ø§Ø¦Ù…Ø© IDs Ø§Ù„Ø±Ù‚ØµØ§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø©
    local emotes = {
        ["Griddy"] = 9606471821, 
        ["Bugha"] = 7212401314, 
        ["Billy"] = 3338340150,
        ["Dancin"] = 5103431709, 
        ["Floss"] = 2825749343, 
        ["Take The L"] = 2825729114,
        ["Default"] = 507771019, 
        ["Robot"] = 507771955, 
        ["Hype"] = 3696748324,
        ["Orange Justice"] = 3696756105, 
        ["Best Mates"] = 3696761332,
        ["L"] = 2825732154,
        ["Zany"] = 6363537781,
        ["Electro"] = 5917459364
    }

    for name, id in pairs(emotes) do
        local btn = Instance.new("TextButton")
        btn.Parent = Scroll
        btn.Size = UDim2.new(0.9, 0, 0, 40)
        btn.Text = name
        btn.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 12
        Instance.new("UICorner", btn)
        
        btn.MouseButton1Click:Connect(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                local anim = Instance.new("Animation")
                anim.AnimationId = "rbxassetid://"..id
                local load = LocalPlayer.Character.Humanoid:LoadAnimation(anim)
                load:Play()
            end
        end)
    end

    -- Ø²Ø± Ø¥ØºÙ„Ø§Ù‚ Ø­Ù‚ÙŠÙ‚ÙŠ ÙŠØ¹Ù…Ù„
    local Close = Instance.new("TextButton", MainFrame)
    Close.Size = UDim2.new(0, 30, 0, 30)
    Close.Position = UDim2.new(1, -35, 0, 7)
    Close.Text = "âœ•"
    Close.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    Close.TextColor3 = Color3.new(1, 1, 1)
    Close.Font = Enum.Font.GothamBold
    Close.TextSize = 16
    
    Close.MouseButton1Click:Connect(function() 
        ScreenGui:Destroy() 
    end)
    
    -- ØªØ­Ø¯ÙŠØ« Ø­Ø¬Ù… CanvasSize Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    task.wait(0.1)
    local buttonCount = 0
    for _ in pairs(emotes) do buttonCount = buttonCount + 1 end
    Scroll.CanvasSize = UDim2.new(0, 0, 0, (buttonCount * 48))
end

-- ========== Ø¥ØµÙ„Ø§Ø­ 2: Wood Shield Ù…Ø­Ø³Ù‘Ù† ÙŠÙ†Ø³Ø­Ø¨ ÙˆÙŠØ«Ø¨Øª ==========
local function EnableWoodShield()
    if WoodShieldActive then return end
    WoodShieldActive = true
    WoodShieldAngle = 0
    
    -- ØªÙ†Ø¸ÙŠÙ Ø£ÙŠ Ø¯Ø±Ø¹ Ù‚Ø¯ÙŠÙ…
    if WoodShieldConnection then
        WoodShieldConnection:Disconnect()
    end
    for _, part in pairs(ActiveWoodParts) do
        if part then part:Destroy() end
    end
    ActiveWoodParts = {}
    LastWoodPositions = {}
    
    WoodShieldConnection = RunService.Heartbeat:Connect(function()
        if not WoodShieldActive or not LocalPlayer.Character then 
            if WoodShieldConnection then
                WoodShieldConnection:Disconnect()
            end
            return 
        end
        
        local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if not hrp then return end
        
        WoodShieldAngle = WoodShieldAngle + 0.05
        
        -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù‚Ø·Ø¹ Ø®Ø´Ø¨ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ø¯Ù‰
        local woodFound = false
        for _, v in pairs(workspace:GetDescendants()) do
            if v:IsA("BasePart") and not v.Anchored and not v:IsDescendantOf(LocalPlayer.Character) 
               and not v.Parent:FindFirstChild("Humanoid") and not v.Parent:IsA("Accessory") then
                
                local isWood = v.Name:lower():find("wood") or 
                              v.Name:lower():find("door") or 
                              v.Name:lower():find("plank") or
                              v.Material == Enum.Material.Wood
                
                if isWood and (v.Position - hrp.Position).Magnitude < 50 then
                    woodFound = true
                    
                    -- Ø­ÙØ¸ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ØµÙ„ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø£ÙˆÙ„ Ù…Ø±Ø©
                    if not LastWoodPositions[v] then
                        LastWoodPositions[v] = {
                            Position = v.Position,
                            Parent = v.Parent,
                            CFrame = v.CFrame
                        }
                    end
                    
                    -- ØªÙ†Ø¸ÙŠÙ Ø£ÙŠ BodyMovers Ù‚Ø¯ÙŠÙ…Ø©
                    for _, child in pairs(v:GetChildren()) do
                        if child:IsA("BodyMover") or child:IsA("AlignPosition") or child:IsA("Attachment") then
                            child:Destroy()
                        end
                    end
                    
                    -- Ø¥Ù†Ø´Ø§Ø¡ BodyMover Ø¬Ø¯ÙŠØ¯ Ù„Ø³Ø­Ø¨ Ø§Ù„Ø®Ø´Ø¨
                    local bodyPos = Instance.new("BodyPosition")
                    bodyPos.Parent = v
                    bodyPos.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
                    bodyPos.P = 15000
                    bodyPos.D = 800
                    
                    -- Ø­Ø³Ø§Ø¨ Ù…ÙˆÙ‚Ø¹ Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø¯Ø§Ø¦Ø±Ø© Ø­ÙˆÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨
                    local radius = 7 + math.sin(WoodShieldAngle * 2) * 1.5
                    local angleOffset = WoodShieldAngle + (ActiveWoodParts[v] or 0)
                    local x = math.cos(angleOffset) * radius
                    local z = math.sin(angleOffset) * radius
                    
                    bodyPos.Position = hrp.Position + Vector3.new(x, 2, z)
                    
                    -- Ø¥Ø¶Ø§ÙØ© Ù‚ÙˆØ© Ø·Ø±Ø¯ Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù‚Ø±ÙŠØ¨ÙŠÙ†
                    for _, player in pairs(Players:GetPlayers()) do
                        if player ~= LocalPlayer and player.Character then
                            local enemyHrp = player.Character:FindFirstChild("HumanoidRootPart")
                            if enemyHrp and (enemyHrp.Position - v.Position).Magnitude < 4 then
                                local pushDirection = (enemyHrp.Position - v.Position).Unit
                                enemyHrp.Velocity = pushDirection * 80 + Vector3.new(0, 20, 0)
                            end
                        end
                    end
                    
                    -- ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© Ù…Ø¤Ù‚ØªØ§Ù‹
                    v.CustomPhysicalProperties = PhysicalProperties.new(0.5, 0.3, 0.4)
                    v.CanCollide = false
                    
                    -- Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†Ø´Ø·Ø©
                    ActiveWoodParts[v] = angleOffset
                    
                    -- ØªØ¯Ù…ÙŠØ± BodyMover Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ© ÙˆØ¥Ø¹Ø§Ø¯ØªÙ‡ Ø¥Ø°Ø§ Ø¨Ù‚ÙŠ Ø§Ù„Ø¯Ø±Ø¹ Ù†Ø´Ø·
                    game:GetService("Debris"):AddItem(bodyPos, 1)
                end
            end
        end
        
        -- Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø®Ø´Ø¨ Ø¥Ù„Ù‰ Ù…ÙƒØ§Ù†Ù‡ Ø§Ù„Ø£ØµÙ„ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¹Ø¯ Ù‚Ø±ÙŠØ¨Ø§Ù‹
        for wood, originalPos in pairs(LastWoodPositions) do
            if wood and wood.Parent and (wood.Position - hrp.Position).Magnitude > 60 then
                local bodyPos = Instance.new("BodyPosition")
                bodyPos.Parent = wood
                bodyPos.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
                bodyPos.Position = originalPos.Position
                bodyPos.P = 8000
                
                task.wait(0.5)
                if bodyPos then bodyPos:Destroy() end
                wood.CustomPhysicalProperties = nil -- Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø®ØµØ§Ø¦Øµ Ø§Ù„Ø£ØµÙ„ÙŠØ©
                wood.CanCollide = true
                
                LastWoodPositions[wood] = nil
                ActiveWoodParts[wood] = nil
            end
        end
        
        -- Ø¥Ø°Ø§ Ù„Ù… ÙŠÙˆØ¬Ø¯ Ø®Ø´Ø¨ØŒ Ù†ÙˆÙ‚Ù Ø§Ù„Ø¯Ø±Ø¹ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
        if not woodFound then
            task.wait(5)
            if not woodFound then
                WoodShieldActive = false
                if WoodShieldConnection then
                    WoodShieldConnection:Disconnect()
                end
            end
        end
    end)
    
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Wood Shield",
        Text = "ON - ÙŠØ³Ø­Ø¨ Ø§Ù„Ø®Ø´Ø¨ ÙˆÙŠØ¨Ù‚Ù‰ Ù…Ø¹Ùƒ",
        Duration = 3
    })
end

local function DisableWoodShield()
    WoodShieldActive = false
    
    if WoodShieldConnection then
        WoodShieldConnection:Disconnect()
        WoodShieldConnection = nil
    end
    
    -- Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø®Ø´Ø¨ Ø¥Ù„Ù‰ Ø£Ù…Ø§ÙƒÙ†Ù‡ Ø§Ù„Ø£ØµÙ„ÙŠØ©
    for wood, originalPos in pairs(LastWoodPositions) do
        if wood and wood.Parent then
            local bodyPos = Instance.new("BodyPosition")
            bodyPos.Parent = wood
            bodyPos.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
            bodyPos.Position = originalPos.Position
            bodyPos.P = 5000
            
            task.wait(0.3)
            if bodyPos then bodyPos:Destroy() end
            wood.CustomPhysicalProperties = nil
            wood.CanCollide = true
        end
    end
    
    ActiveWoodParts = {}
    LastWoodPositions = {}
    
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Wood Shield",
        Text = "OFF - Ø§Ù„Ø®Ø´Ø¨ Ø¹Ø§Ø¯ Ù„Ù…ÙƒØ§Ù†Ù‡",
        Duration = 3
    })
end

-- ========== Ø¥ØµÙ„Ø§Ø­ 3: ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…ÙØªØ§Ø­ - Ù„Ø§ ØªØ­ØªØ§Ø¬ Ø­Ø°Ù ÙŠØ¯ÙˆÙŠ ==========
local function CreateKeyGui()
    local KeyGui = Instance.new("ScreenGui", game.CoreGui)
    KeyGui.Name = "WallhanKeyGui"
    
    local KeyFrame = Instance.new("Frame", KeyGui)
    KeyFrame.Size = UDim2.new(0, 320, 0, 200)
    KeyFrame.Position = UDim2.new(0.5, -160, 0.5, -100)
    KeyFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    KeyFrame.Active = true
    KeyFrame.Draggable = true
    
    local uiCorner = Instance.new("UICorner", KeyFrame)
    uiCorner.CornerRadius = UDim.new(0, 10)
    
    local uiStroke = Instance.new("UIStroke", KeyFrame)
    uiStroke.Color = Color3.fromRGB(200, 0, 0)
    uiStroke.Thickness = 2
    
    -- Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
    local Title = Instance.new("TextLabel", KeyFrame)
    Title.Size = UDim2.new(1, 0, 0, 50)
    Title.Text = "ğŸ” WALLHAN HUB - ACCESS"
    Title.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    Title.TextColor3 = Color3.new(1, 1, 1)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 16
    Instance.new("UICorner", Title)
    
    -- Ù†Øµ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
    local HelpText = Instance.new("TextLabel", KeyFrame)
    HelpText.Size = UDim2.new(0.8, 0, 0, 30)
    HelpText.Position = UDim2.new(0.1, 0, 0.25, 0)
    HelpText.Text = "Enter Key: (daddy)"
    HelpText.TextColor3 = Color3.fromRGB(200, 200, 200)
    HelpText.BackgroundTransparency = 1
    HelpText.Font = Enum.Font.Gotham
    HelpText.TextSize = 12
    HelpText.TextXAlignment = Enum.TextXAlignment.Left
    
    -- Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ - Ù…Ø¹ Ø²Ø± Ù…Ø³Ø­ Ø¯Ø§Ø®Ù„ÙŠ
    local InputContainer = Instance.new("Frame", KeyFrame)
    InputContainer.Size = UDim2.new(0.8, 0, 0, 40)
    InputContainer.Position = UDim2.new(0.1, 0, 0.4, 0)
    InputContainer.BackgroundColor3 = Color3.fromRGB(30, 0, 0)
    InputContainer.BackgroundTransparency = 0
    Instance.new("UICorner", InputContainer)
    
    local KeyInput = Instance.new("TextBox", InputContainer)
    KeyInput.Size = UDim2.new(0.85, 0, 1, 0)
    KeyInput.Position = UDim2.new(0, 0, 0, 0)
    KeyInput.PlaceholderText = "Type key here..."
    KeyInput.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
    KeyInput.Text = "" -- Ø¯Ø§Ø¦Ù…Ø§Ù‹ ÙŠØ¨Ø¯Ø£ ÙØ§Ø±ØºØ§Ù‹
    KeyInput.TextColor3 = Color3.new(1, 1, 1)
    KeyInput.BackgroundTransparency = 1
    KeyInput.ClearTextOnFocus = false
    KeyInput.Font = Enum.Font.Gotham
    KeyInput.TextSize = 14
    
    -- Ø²Ø± Ù…Ø³Ø­ Ø¯Ø§Ø®Ù„ Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
    local ClearButton = Instance.new("TextButton", InputContainer)
    ClearButton.Size = UDim2.new(0.15, 0, 0.7, 0)
    ClearButton.Position = UDim2.new(0.85, 0, 0.15, 0)
    ClearButton.Text = "âœ•"
    ClearButton.BackgroundColor3 = Color3.fromRGB(80, 0, 0)
    ClearButton.TextColor3 = Color3.new(1, 1, 1)
    ClearButton.Font = Enum.Font.GothamBold
    ClearButton.TextSize = 12
    Instance.new("UICorner", ClearButton)
    
    ClearButton.MouseButton1Click:Connect(function()
        KeyInput.Text = ""
        KeyInput.PlaceholderText = "Type key here..."
    end)
    
    -- Ø²Ø± Ø§Ù„ØªÙØ¹ÙŠÙ„
    local Submit = Instance.new("TextButton", KeyFrame)
    Submit.Size = UDim2.new(0.8, 0, 0, 45)
    Submit.Position = UDim2.new(0.1, 0, 0.7, 0)
    Submit.Text = "ğŸ”“ ACTIVATE"
    Submit.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    Submit.TextColor3 = Color3.new(1, 1, 1)
    Submit.Font = Enum.Font.GothamBold
    Submit.TextSize = 14
    Instance.new("UICorner", Submit)
    
    -- Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    ClearButton.MouseButton1Click:Connect(function()
        KeyInput.Text = ""
        KeyInput:CaptureFocus()
    end)
    
    Submit.MouseButton1Click:Connect(function()
        local enteredKey = KeyInput.Text
        
        if enteredKey == MASTER_KEY or VALID_KEYS[enteredKey] then
            Submit.Text = "âœ… ACCESS GRANTED!"
            Submit.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
            
            task.wait(0.5)
            KeyGui:Destroy()
            StartWallhan()
        else
            local originalText = Submit.Text
            Submit.Text = "âŒ INVALID KEY!"
            Submit.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
            
            KeyInput.Text = ""
            KeyInput.PlaceholderText = "Wrong! Try again..."
            
            task.wait(0.8)
            Submit.Text = originalText
            Submit.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
        end
    end)
    
    -- Ø§Ù„ØªØ±ÙƒÙŠØ² Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
    task.wait(0.3)
    KeyInput:CaptureFocus()
end

-- ========== Ø§Ù„Ø¨Ø§Ù‚ÙŠ Ù…Ù† Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø£ØµÙ„ÙŠ Ù…Ø¹ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¨Ø³ÙŠØ·Ø© ==========
local function StartWallhan()
    local _G_States = { ESP = false, Noclip = false, WoodShield = false, AntiFling = false }
    
    local sg = Instance.new("ScreenGui", game.CoreGui)
    local Main = Instance.new("Frame", sg)
    Main.Size, Main.Position = UDim2.new(0, 260, 0, 580), UDim2.new(1, -270, 0.5, -290)
    Main.BackgroundColor3, Main.Active, Main.Draggable = Color3.fromRGB(0, 0, 0), true, true
    Main.BackgroundTransparency = 0.1
    Instance.new("UIStroke", Main).Color = Color3.fromRGB(150, 0, 0)
    Instance.new("UICorner", Main)

    local List = Instance.new("ScrollingFrame", Main)
    List.Size, List.Position = UDim2.new(1, -15, 1, -70), UDim2.new(0, 7, 0, 60)
    List.BackgroundTransparency, List.CanvasSize = 1, UDim2.new(0, 0, 3.2, 0)
    List.ScrollBarThickness = 6
    Instance.new("UIListLayout", List).Padding = UDim.new(0, 8)

    local function CreateButton(txt, cb)
        local b = Instance.new("TextButton", List)
        b.Size, b.BackgroundColor3, b.Text = UDim2.new(0.95, 0, 0, 40), Color3.fromRGB(130, 0, 0), txt
        b.TextColor3, b.Font = Color3.new(1,1,1), Enum.Font.GothamBold
        b.TextSize = 12
        Instance.new("UIStroke", b).Thickness = 1
        Instance.new("UICorner", b)
        b.MouseButton1Click:Connect(cb)
    end

    local function CreateToggle(txt, stateKey, enableFunc, disableFunc)
        local b = Instance.new("TextButton", List)
        b.Size, b.Font = UDim2.new(0.95, 0, 0, 40), Enum.Font.GothamBold
        b.TextSize = 12
        
        local function Upd()
            b.Text = txt .. (_G_States[stateKey] and " [ON]" or " [OFF]")
            b.BackgroundColor3 = _G_States[stateKey] and Color3.fromRGB(200, 0, 0) or Color3.fromRGB(45, 0, 0)
        end
        
        b.MouseButton1Click:Connect(function() 
            _G_States[stateKey] = not _G_States[stateKey] 
            if _G_States[stateKey] then
                if enableFunc then enableFunc() end
            else
                if disableFunc then disableFunc() end
            end
            Upd() 
        end)
        Upd()
        Instance.new("UICorner", b)
        return b
    end

    -- Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    CreateButton("SET CHECKPOINT ğŸš©", function()
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            SavedCheckpoint = LocalPlayer.Character.HumanoidRootPart.CFrame
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Wallhan Hub",
                Text = "Checkpoint Saved! âœ…",
                Duration = 3
            })
        end
    end)

    CreateButton("TP TO CHECKPOINT ğŸŒ€", function()
        if SavedCheckpoint and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            LocalPlayer.Character.HumanoidRootPart.CFrame = SavedCheckpoint
        else
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Wallhan Hub",
                Text = "No Checkpoint Set! âŒ",
                Duration = 3
            })
        end
    end)

    CreateButton("RANDOM PLAYER TP ğŸ²", function()
        local plrs = Players:GetPlayers()
        local targets = {}
        for _, p in pairs(plrs) do
            if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                table.insert(targets, p)
            end
        end
        if #targets > 0 then
            local rP = targets[math.random(1, #targets)]
            LocalPlayer.Character:SetPrimaryPartCFrame(rP.Character.HumanoidRootPart.CFrame + Vector3.new(0, 5, 0))
        end
    end)

    CreateButton("WALLHAN EMOTES ğŸ•º", OpenWallhanEmotes)

    CreateButton("GIVE TELEPORT TOOL ğŸ“", function()
        local tp = Instance.new("Tool", LocalPlayer.Backpack)
        tp.Name, tp.RequiresHandle = "Wallhan TP ğŸ“", false
        tp.Activated:Connect(function() 
            if LocalPlayer.Character and Mouse.Hit then
                LocalPlayer.Character:MoveTo(Mouse.Hit.p + Vector3.new(0, 3, 0))
            end
        end)
    end)
    
    -- Ø§Ù„ØªÙ‚Ù„Ø¨Ø§Øª Ù…Ø¹ Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„/Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù
    CreateToggle("ULTIMATE ANTI-FLING ğŸ›¡ï¸", "AntiFling", 
        function()
            RunService.Heartbeat:Connect(function()
                if _G_States.AntiFling and LocalPlayer.Character then
                    local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                    if hrp and hrp.AssemblyLinearVelocity.Magnitude > 100 then
                        hrp.Velocity = Vector3.new(0, 0, 0)
                        hrp.RotVelocity = Vector3.new(0, 0, 0)
                    end
                end
            end)
        end,
        function()
            -- Ù„Ø§ Ø´ÙŠØ¡ Ø®Ø§Øµ Ù„Ù„Ø¥ÙŠÙ‚Ø§Ù
        end
    )
    
    CreateToggle("WOOD SHIELD ğŸŒªï¸", "WoodShield", EnableWoodShield, DisableWoodShield)
    
    -- ESP Ùˆ Noclip ÙŠØ¨Ù‚ÙˆÙ† ÙƒÙ…Ø§ Ù‡Ù…
    CreateToggle("BOX ESP + NAMES ğŸ‘ï¸", "ESP")
    CreateToggle("NOCLIP ğŸ§±", "Noclip")

    -- Noclip Loop
    RunService.Stepped:Connect(function()
        if _G_States.Noclip and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.PlatformStand = false
            for _, v in pairs(LocalPlayer.Character:GetDescendants()) do
                if v:IsA("BasePart") then v.CanCollide = false end
            end
        end
    end)

    -- ESP Loop
    RunService.RenderStepped:Connect(function()
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= LocalPlayer and p.Character then
                if _G_States.ESP then
                    if not p.Character:FindFirstChild("BoxESP") then
                        local b = Instance.new("BoxHandleAdornment", p.Character)
                        b.Name, b.AlwaysOnTop, b.Adornee = "BoxESP", true, p.Character
                        b.Size, b.Color3, b.Transparency = p.Character:GetExtentsSize(), Color3.new(1,0,0), 0.6
                        
                        local bill = Instance.new("BillboardGui", p.Character)
                        bill.Name, bill.Size, bill.AlwaysOnTop = "NameESP", UDim2.new(0, 100, 0, 50), true
                        bill.Adornee = p.Character:FindFirstChild("Head")
                        
                        local lbl = Instance.new("TextLabel", bill)
                        lbl.Size, lbl.Text = UDim2.new(1, 0, 1, 0), p.Name
                        lbl.BackgroundTransparency, lbl.TextColor3 = 1, Color3.new(1,0,0)
                        lbl.Font, lbl.TextSize = Enum.Font.GothamBold, 14
                        Instance.new("UIStroke", lbl).Thickness = 1
                    end
                else
                    if p.Character:FindFirstChild("BoxESP") then p.Character.BoxESP:Destroy() end
                    if p.Character:FindFirstChild("NameESP") then p.Character.NameESP:Destroy() end
                end
            end
        end
    end)

    -- Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    local ToggleBtn = Instance.new("TextButton", sg)
    ToggleBtn.Size, ToggleBtn.Position = UDim2.new(0, 50, 0, 50), UDim2.new(0, 20, 0, 20)
    ToggleBtn.BackgroundColor3, ToggleBtn.Text = Color3.new(0,0,0), "W"
    ToggleBtn.TextColor3, ToggleBtn.Font, ToggleBtn.TextSize = Color3.fromRGB(200, 0, 0), Enum.Font.GothamBold, 25
    ToggleBtn.BackgroundTransparency = 0.2
    ToggleBtn.Draggable = true
    Instance.new("UIStroke", ToggleBtn).Color = Color3.fromRGB(200, 0, 0)
    Instance.new("UICorner", ToggleBtn).CornerRadius = UDim.new(1, 0)
    ToggleBtn.MouseButton1Click:Connect(function() Main.Visible = not Main.Visible end)
    
    -- Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Wallhan Hub",
        Text = "Enhanced Version Loaded! âœ…",
        Duration = 4
    })
end

-- Ø¨Ø¯Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…ÙØªØ§Ø­
CreateKeyGui()
