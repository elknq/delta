-- Wallhan Hub - Enhanced Version
-- Developer: Enhanced with true physics-based features

local MASTER_KEY = "daddy"
local VALID_KEYS = {["0x1xxxxjwj"] = true, ["iloveyoudaddywallhan"] = true}

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- Ù…ØªØºÙŠØ± Ù„Ø­ÙØ¸ Ù†Ù‚Ø·Ø© Ø§Ù„ØªØ´ÙŠÙƒ Ø¨ÙˆÙŠÙ†Øª
local SavedCheckpoint = nil
local ActiveWoodParts = {}
local AntiFlingConnection = nil
local ESPConnections = {}
local NoclipConnection = nil

-- [[ Ø¯Ø§Ù„Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø±Ù‚ØµØ§Øª Ø§Ù„Ù…Ø¯Ù…Ø¬Ø© ]]
local function OpenWallhanEmotes()
    local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
    ScreenGui.Name = "WallhanEmotesMenu"
    
    local MainFrame = Instance.new("Frame", ScreenGui)
    MainFrame.Size = UDim2.new(0, 400, 0, 320)
    MainFrame.Position = UDim2.new(0.5, -200, 0.5, -160)
    MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    MainFrame.Active = true
    MainFrame.Draggable = true
    Instance.new("UICorner", MainFrame)
    local stroke = Instance.new("UIStroke", MainFrame)
    stroke.Color = Color3.fromRGB(200, 0, 0)
    stroke.Thickness = 2

    local Title = Instance.new("TextLabel", MainFrame)
    Title.Size = UDim2.new(1, 0, 0, 45)
    Title.Text = "ğŸ•º WALLHAN EMOTES ğŸ•º"
    Title.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    Title.TextColor3 = Color3.new(1, 1, 1)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 18
    Instance.new("UICorner", Title)

    local Scroll = Instance.new("ScrollingFrame", MainFrame)
    Scroll.Size = UDim2.new(1, -10, 1, -60)
    Scroll.Position = UDim2.new(0, 5, 0, 50)
    Scroll.BackgroundTransparency = 1
    Scroll.CanvasSize = UDim2.new(0, 0, 4, 0)
    local layout = Instance.new("UIGridLayout", Scroll)
    layout.CellSize = UDim2.new(0, 120, 0, 40)
    layout.Padding = UDim2.new(0, 8, 0, 8)

    local emotes = {
        ["Griddy"] = 9606471821, ["Bugha"] = 7212401314, ["Billy"] = 3338340150,
        ["Dancin"] = 5103431709, ["Floss"] = 2825749343, ["Take The L"] = 2825729114,
        ["Default"] = 507771019, ["Robot"] = 507771955, ["Hype"] = 3696748324,
        ["Orange Justice"] = 3696756105, ["Best Mates"] = 3696761332
    }

    for name, id in pairs(emotes) do
        local btn = Instance.new("TextButton", Scroll)
        btn.Text = name
        btn.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 12
        Instance.new("UICorner", btn)
        btn.MouseButton1Click:Connect(function()
            local anim = Instance.new("Animation")
            anim.AnimationId = "rbxassetid://"..id
            local load = LocalPlayer.Character.Humanoid:LoadAnimation(anim)
            load:Play()
        end)
    end

    local Close = Instance.new("TextButton", MainFrame)
    Close.Size = UDim2.new(0, 30, 0, 30)
    Close.Position = UDim2.new(1, -35, 0, 7)
    Close.Text = "X"
    Close.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    Close.TextColor3 = Color3.new(1, 1, 1)
    Close.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)
end

-- [[ ULTIMATE WOOD SHIELD - ENHANCED (REAL PARTS SEEN BY ALL) ]]
local function CreateWoodShield()
    -- ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¯Ø±Ø¹ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
    for _, part in pairs(ActiveWoodParts) do
        if part then part:Destroy() end
    end
    ActiveWoodParts = {}
    
    if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        return
    end
    
    local hrp = LocalPlayer.Character.HumanoidRootPart
    
    -- Ø¥Ù†Ø´Ø§Ø¡ 8 Ù‚Ø·Ø¹ Ø®Ø´Ø¨ÙŠØ© Ø­Ù‚ÙŠÙ‚ÙŠØ© (ÙŠØ±Ø§Ù‡Ø§ Ø§Ù„Ø¬Ù…ÙŠØ¹)
    for i = 1, 8 do
        local wood = Instance.new("Part")
        wood.Name = "WallhanWoodShield"
        wood.Size = Vector3.new(2, 4, 0.5)
        wood.Material = Enum.Material.Wood
        wood.Color = Color3.fromRGB(102, 64, 32) -- Ù„ÙˆÙ† Ø®Ø´Ø¨ÙŠ
        wood.Anchored = false
        wood.CanCollide = true
        wood.Massless = false
        wood.CustomPhysicalProperties = PhysicalProperties.new(0.7, 0.3, 0.5) -- Ø®ØµØ§Ø¦Øµ Ø®Ø´Ø¨ÙŠØ©
        
        -- Ø¬Ø¹Ù„ Ø§Ù„Ù‚Ø·Ø¹Ø© Ø¬Ø²Ø¡Ø§Ù‹ Ù…Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø­ØªÙ‰ ØªØªØ¨Ø¹ Ø§Ù„Ø¬Ù…ÙŠØ¹ Ø±Ø¤ÙŠØªÙ‡Ø§
        wood.Parent = workspace
        
        -- ØªØ¯Ù…ÙŠØ± Ø§Ù„Ù‚Ø·Ø¹Ø© Ø¥Ø°Ø§ Ø³Ù‚Ø·Øª Ø¨Ø¹ÙŠØ¯Ø§Ù‹
        game:GetService("Debris"):AddItem(wood, 60)
        
        -- Ø¥Ø¶Ø§ÙØ© Ù‚ÙˆØ© Ø¬Ø°Ø¨ Ù†Ø­Ùˆ Ù…Ø±ÙƒØ² Ø§Ù„Ù„Ø§Ø¹Ø¨
        local bodyPosition = Instance.new("BodyPosition", wood)
        bodyPosition.MaxForce = Vector3.new(4000, 4000, 4000)
        bodyPosition.P = 10000
        
        -- Ø¥Ø¶Ø§ÙØ© Ù‚ÙˆØ© Ø·Ø±Ø¯ Ù…Ø±ÙƒØ²ÙŠ
        local bodyGyro = Instance.new("BodyGyro", wood)
        bodyGyro.MaxTorque = Vector3.new(4000, 4000, 4000)
        
        table.insert(ActiveWoodParts, wood)
    end
    
    -- ØªØ­Ø¯ÙŠØ« Ø­Ø±ÙƒØ© Ø§Ù„Ù‚Ø·Ø¹ Ø§Ù„Ø®Ø´Ø¨ÙŠØ©
    local angle = 0
    local shieldConnection = RunService.Heartbeat:Connect(function()
        if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            shieldConnection:Disconnect()
            return
        end
        
        hrp = LocalPlayer.Character.HumanoidRootPart
        angle = angle + 0.08
        
        for i, wood in pairs(ActiveWoodParts) do
            if wood and wood.Parent then
                local radians = angle + (i * math.pi / 4) -- 8 Ù‚Ø·Ø¹ Ù…ÙˆØ²Ø¹Ø© Ø¯Ø§Ø¦Ø±ÙŠØ§Ù‹
                local radius = 5 + math.sin(angle + i) * 0.5 -- Ù†ØµÙ Ù…ØªØºÙŠØ± Ù‚Ù„ÙŠÙ„Ø§Ù‹
                
                local targetPosition = hrp.Position + 
                    Vector3.new(
                        math.cos(radians) * radius,
                        2 + math.sin(angle * 2 + i) * 0.3, -- Ø­Ø±ÙƒØ© Ø¹Ù…ÙˆØ¯ÙŠØ© Ø·ÙÙŠÙØ©
                        math.sin(radians) * radius
                    )
                
                -- ØªØ­Ø¯ÙŠØ« Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù‚Ø·Ø¹
                if wood:FindFirstChild("BodyPosition") then
                    wood.BodyPosition.Position = targetPosition
                end
                
                if wood:FindFirstChild("BodyGyro") then
                    wood.BodyGyro.CFrame = CFrame.lookAt(wood.Position, hrp.Position)
                end
                
                -- ØªØ·Ø¨ÙŠÙ‚ Ù‚ÙˆØ© Ø¯ÙØ§Ø¹ ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¶Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù‚Ø±ÙŠØ¨ÙŠÙ†
                for _, player in pairs(Players:GetPlayers()) do
                    if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                        local enemyHrp = player.Character.HumanoidRootPart
                        local distance = (wood.Position - enemyHrp.Position).Magnitude
                        
                        if distance < 3 then
                            -- Ù‚ÙˆØ© Ø¯ÙØ§Ø¹ ØªÙ†Ø¨ÙŠÙ‡ÙŠØ©
                            local pushForce = (enemyHrp.Position - wood.Position).Unit * 50
                            enemyHrp.Velocity = enemyHrp.Velocity + pushForce + Vector3.new(0, 15, 0)
                        end
                    end
                end
            end
        end
    end)
    
    -- Ø­ÙØ¸ Ø§Ù„Ù…Ø±Ø¬Ø¹ Ù„Ù„ØªØ¯Ù…ÙŠØ± Ù„Ø§Ø­Ù‚Ø§Ù‹
    table.insert(ActiveWoodParts, shieldConnection)
    
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Wallhan Hub",
        Text = "Wood Shield Activated! (Real Physics)",
        Duration = 3
    })
end

local function DestroyWoodShield()
    for _, item in pairs(ActiveWoodParts) do
        if typeof(item) == "RBXScriptConnection" then
            item:Disconnect()
        elseif item:IsA("BasePart") then
            item:Destroy()
        end
    end
    ActiveWoodParts = {}
end

-- [[ ULTIMATE ANTI-FLING - ENHANCED ]]
local function EnableAntiFling()
    if AntiFlingConnection then
        AntiFlingConnection:Disconnect()
    end
    
    AntiFlingConnection = RunService.Heartbeat:Connect(function()
        if not LocalPlayer.Character then return end
        
        local humanoid = LocalPlayer.Character:FindFirstChild("Humanoid")
        local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        
        if humanoid and hrp then
            -- Ù…Ù†Ø¹ PlatformStand Ù„Ù…Ù†Ø¹ Ø§Ù„Ø³Ù‚ÙˆØ·
            humanoid.PlatformStand = false
            
            -- Ù…Ù‚Ø§ÙˆÙ…Ø© Ù‚ÙˆÙ‰ Ø§Ù„Ø·Ø±Ø¯ Ø§Ù„Ù…ÙØ§Ø¬Ø¦Ø©
            if hrp.AssemblyLinearVelocity.Magnitude > 100 then
                hrp.AssemblyLinearVelocity = hrp.AssemblyLinearVelocity * 0.3
            end
            
            if hrp.AssemblyAngularVelocity.Magnitude > 50 then
                hrp.AssemblyAngularVelocity = Vector3.new(0, 0, 0)
            end
            
            -- Ø¥Ø¹Ø§Ø¯Ø© ØªØ«Ø¨ÙŠØª Ø¥Ø°Ø§ Ø·Ø§Ø± Ø¨Ø¹ÙŠØ¯Ø§Ù‹
            if hrp.Position.Y < workspace.FallenPartsDestroyHeight + 10 then
                if SavedCheckpoint then
                    hrp.CFrame = SavedCheckpoint
                else
                    hrp.CFrame = CFrame.new(0, 50, 0)
                end
            end
        end
    end)
end

-- [[ BOX ESP + NAMES - ENHANCED ]]
local function EnableESP()
    local function CreateESP(player)
        if player == LocalPlayer or not player.Character then return end
        
        local character = player.Character
        local head = character:WaitForChild("Head", 2)
        if not head then return end
        
        -- Box ESP
        local box = Instance.new("BoxHandleAdornment")
        box.Name = "WallhanBoxESP"
        box.Adornee = character
        box.AlwaysOnTop = true
        box.Size = character:GetExtentsSize()
        box.Color3 = player.Team == LocalPlayer.Team and Color3.new(0, 1, 0) or Color3.new(1, 0, 0)
        box.Transparency = 0.4
        box.ZIndex = 10
        box.Parent = character
        
        -- Name Tag
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "WallhanNameESP"
        billboard.Size = UDim2.new(0, 200, 0, 50)
        billboard.AlwaysOnTop = true
        billboard.StudsOffset = Vector3.new(0, 3.5, 0)
        billboard.Adornee = head
        billboard.Parent = character
        
        local textLabel = Instance.new("TextLabel", billboard)
        textLabel.Size = UDim2.new(1, 0, 1, 0)
        textLabel.BackgroundTransparency = 1
        textLabel.Text = player.Name
        textLabel.TextColor3 = Color3.new(1, 1, 1)
        textLabel.TextStrokeTransparency = 0
        textLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
        textLabel.Font = Enum.Font.GothamBold
        textLabel.TextSize = 14
        
        -- Health Indicator
        local humanoid = character:FindFirstChild("Humanoid")
        if humanoid then
            local healthLabel = Instance.new("TextLabel", billboard)
            healthLabel.Size = UDim2.new(1, 0, 0, 20)
            healthLabel.Position = UDim2.new(0, 0, 1, 0)
            healthLabel.BackgroundTransparency = 1
            healthLabel.TextColor3 = Color3.new(1, 1, 1)
            healthLabel.Font = Enum.Font.Gotham
            healthLabel.TextSize = 12
            
            local function updateHealth()
                healthLabel.Text = "HP: " .. math.floor(humanoid.Health) .. "/" .. math.floor(humanoid.MaxHealth)
                healthLabel.TextColor3 = Color3.fromRGB(
                    255 - (humanoid.Health / humanoid.MaxHealth * 255),
                    humanoid.Health / humanoid.MaxHealth * 255,
                    0
                )
            end
            
            updateHealth()
            humanoid.HealthChanged:Connect(updateHealth)
        end
        
        ESPConnections[player] = {box, billboard}
    end
    
    -- ØªØ·Ø¨ÙŠÙ‚ ESP Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†
    for _, player in pairs(Players:GetPlayers()) do
        CreateESP(player)
    end
    
    -- Ø¥Ø¶Ø§ÙØ© ESP Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯
    Players.PlayerAdded:Connect(CreateESP)
end

local function DisableESP()
    for player, objects in pairs(ESPConnections) do
        if player.Character then
            for _, obj in pairs(objects) do
                if obj then obj:Destroy() end
            end
        end
    end
    ESPConnections = {}
end

-- [[ NOCLIP - ENHANCED ]]
local function EnableNoclip()
    if NoclipConnection then
        NoclipConnection:Disconnect()
    end
    
    NoclipConnection = RunService.Stepped:Connect(function()
        if not LocalPlayer.Character then return end
        
        local humanoid = LocalPlayer.Character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid:ChangeState(11) -- NoClip state
        end
        
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
                part.Velocity = Vector3.new(0, 0, 0)
            end
        end
    end)
end

-- [[ START CORE - ENHANCED ]]
local function StartWallhan()
    local _G_States = { 
        ESP = false, 
        Noclip = false, 
        WoodShield = false, 
        AntiFling = false 
    }
    
    local sg = Instance.new("ScreenGui", game.CoreGui)
    sg.Name = "WallhanHub"
    
    local Main = Instance.new("Frame", sg)
    Main.Size = UDim2.new(0, 280, 0, 600)
    Main.Position = UDim2.new(1, -290, 0.5, -300)
    Main.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Main.BackgroundTransparency = 0.1
    Main.Active = true
    Main.Draggable = true
    Main.Visible = true
    
    local uiCorner = Instance.new("UICorner", Main)
    uiCorner.CornerRadius = UDim.new(0, 8)
    
    local uiStroke = Instance.new("UIStroke", Main)
    uiStroke.Color = Color3.fromRGB(200, 0, 0)
    uiStroke.Thickness = 2
    
    -- Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
    local Title = Instance.new("TextLabel", Main)
    Title.Size = UDim2.new(1, 0, 0, 45)
    Title.Position = UDim2.new(0, 0, 0, 0)
    Title.Text = "ğŸ›¡ï¸ WALLHAN HUB ğŸ›¡ï¸"
    Title.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    Title.TextColor3 = Color3.new(1, 1, 1)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 18
    Instance.new("UICorner", Title)
    
    -- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    local List = Instance.new("ScrollingFrame", Main)
    List.Size = UDim2.new(1, -15, 1, -120)
    List.Position = UDim2.new(0, 7, 0, 55)
    List.BackgroundTransparency = 1
    List.CanvasSize = UDim2.new(0, 0, 3.5, 0)
    List.ScrollBarThickness = 4
    
    local layout = Instance.new("UIListLayout", List)
    layout.Padding = UDim.new(0, 8)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    
    local function CreateButton(txt, callback)
        local btn = Instance.new("TextButton", List)
        btn.Size = UDim2.new(0.95, 0, 0, 42)
        btn.BackgroundColor3 = Color3.fromRGB(30, 0, 0)
        btn.Text = txt
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 13
        btn.AutoButtonColor = true
        
        local btnCorner = Instance.new("UICorner", btn)
        btnCorner.CornerRadius = UDim.new(0, 6)
        
        local btnStroke = Instance.new("UIStroke", btn)
        btnStroke.Color = Color3.fromRGB(100, 0, 0)
        btnStroke.Thickness = 1
        
        btn.MouseButton1Click:Connect(callback)
        
        -- ØªØ£Ø«ÙŠØ± Hover
        btn.MouseEnter:Connect(function()
            game:GetService("TweenService"):Create(
                btn, 
                TweenInfo.new(0.2), 
                {BackgroundColor3 = Color3.fromRGB(50, 0, 0)}
            ):Play()
        end)
        
        btn.MouseLeave:Connect(function()
            game:GetService("TweenService"):Create(
                btn, 
                TweenInfo.new(0.2), 
                {BackgroundColor3 = Color3.fromRGB(30, 0, 0)}
            ):Play()
        end)
        
        return btn
    end
    
    local function CreateToggle(txt, stateKey, onEnable, onDisable)
        local btn = Instance.new("TextButton", List)
        btn.Size = UDim2.new(0.95, 0, 0, 42)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 13
        btn.AutoButtonColor = true
        
        local btnCorner = Instance.new("UICorner", btn)
        btnCorner.CornerRadius = UDim.new(0, 6)
        
        local btnStroke = Instance.new("UIStroke", btn)
        btnStroke.Thickness = 1
        
        local function UpdateAppearance()
            if _G_States[stateKey] then
                btn.Text = "âœ… " .. txt .. " âœ…"
                btn.BackgroundColor3 = Color3.fromRGB(0, 30, 0)
                btnStroke.Color = Color3.fromRGB(0, 150, 0)
            else
                btn.Text = "âŒ " .. txt .. " âŒ"
                btn.BackgroundColor3 = Color3.fromRGB(30, 0, 0)
                btnStroke.Color = Color3.fromRGB(150, 0, 0)
            end
        end
        
        btn.MouseButton1Click:Connect(function()
            _G_States[stateKey] = not _G_States[stateKey]
            
            if _G_States[stateKey] then
                if onEnable then onEnable() end
                game:GetService("StarterGui"):SetCore("SendNotification", {
                    Title = "Wallhan Hub",
                    Text = txt .. " Enabled!",
                    Duration = 2
                })
            else
                if onDisable then onDisable() end
                game:GetService("StarterGui"):SetCore("SendNotification", {
                    Title = "Wallhan Hub",
                    Text = txt .. " Disabled!",
                    Duration = 2
                })
            end
            
            UpdateAppearance()
        end)
        
        UpdateAppearance()
        return btn
    end
    
    -- Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    CreateButton("ğŸ’¾ SET CHECKPOINT", function()
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            SavedCheckpoint = LocalPlayer.Character.HumanoidRootPart.CFrame
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Wallhan Hub",
                Text = "Checkpoint Saved! âœ…",
                Icon = "rbxassetid://445366433",
                Duration = 3
            })
        end
    end)
    
    CreateButton("ğŸŒ€ TP TO CHECKPOINT", function()
        if SavedCheckpoint and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            LocalPlayer.Character.HumanoidRootPart.CFrame = SavedCheckpoint
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Wallhan Hub",
                Text = "Teleported to Checkpoint!",
                Duration = 2
            })
        else
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Wallhan Hub",
                Text = "No Checkpoint Set! âŒ",
                Duration = 3
            })
        end
    end)
    
    CreateButton("ğŸ² RANDOM PLAYER TP", function()
        local plrs = Players:GetPlayers()
        local targets = {}
        
        for _, player in pairs(plrs) do
            if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                table.insert(targets, player)
            end
        end
        
        if #targets > 0 then
            local randomPlayer = targets[math.random(1, #targets)]
            LocalPlayer.Character:SetPrimaryPartCFrame(
                randomPlayer.Character.HumanoidRootPart.CFrame + Vector3.new(0, 5, 0)
            )
            
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Wallhan Hub",
                Text = "Teleported to " .. randomPlayer.Name,
                Duration = 3
            })
        end
    end)
    
    CreateButton("ğŸ•º WALLHAN EMOTES", OpenWallhanEmotes)
    
    CreateButton("ğŸ“ GIVE TELEPORT TOOL", function()
        local tool = Instance.new("Tool", LocalPlayer.Backpack)
        tool.Name = "Wallhan TP ğŸ“"
        tool.RequiresHandle = false
        
        local clickSound = Instance.new("Sound", tool)
        clickSound.SoundId = "rbxassetid://130785433"
        
        tool.Activated:Connect(function()
            clickSound:Play()
            if LocalPlayer.Character and Mouse.Hit then
                local target = Mouse.Hit.p + Vector3.new(0, 3, 0)
                LocalPlayer.Character:MoveTo(target)
            end
        end)
    end)
    
    -- Ø§Ù„ØªÙ‚Ù„Ø¨Ø§Øª (Toggles)
    CreateToggle("WOOD SHIELD ğŸŒªï¸", "WoodShield", CreateWoodShield, DestroyWoodShield)
    CreateToggle("ULTIMATE ANTI-FLING ğŸ›¡ï¸", "AntiFling", EnableAntiFling, function()
        if AntiFlingConnection then
            AntiFlingConnection:Disconnect()
            AntiFlingConnection = nil
        end
    end)
    
    CreateToggle("BOX ESP + NAMES ğŸ‘ï¸", "ESP", EnableESP, DisableESP)
    
    CreateToggle("NOCLIP ğŸ§±", "Noclip", EnableNoclip, function()
        if NoclipConnection then
            NoclipConnection:Disconnect()
            NoclipConnection = nil
        end
    end)
    
    -- Ø²Ø± Ø¥ØºÙ„Ø§Ù‚/ÙØªØ­ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    local ToggleBtn = Instance.new("TextButton", sg)
    ToggleBtn.Size = UDim2.new(0, 50, 0, 50)
    ToggleBtn.Position = UDim2.new(0, 20, 0.5, -25)
    ToggleBtn.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    ToggleBtn.BackgroundTransparency = 0.2
    ToggleBtn.Text = "âš™ï¸"
    ToggleBtn.TextColor3 = Color3.fromRGB(255, 50, 50)
    ToggleBtn.Font = Enum.Font.GothamBold
    ToggleBtn.TextSize = 24
    ToggleBtn.Draggable = true
    
    local toggleCorner = Instance.new("UICorner", ToggleBtn)
    toggleCorner.CornerRadius = UDim.new(1, 0)
    
    local toggleStroke = Instance.new("UIStroke", ToggleBtn)
    toggleStroke.Color = Color3.fromRGB(255, 50, 50)
    toggleStroke.Thickness = 2
    
    ToggleBtn.MouseButton1Click:Connect(function()
        Main.Visible = not Main.Visible
        ToggleBtn.Text = Main.Visible and "âš™ï¸" or "ğŸ®"
    end)
    
    -- ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "WALLHAN HUB",
        Text = "Enhanced Version Loaded! ğŸš€",
        Icon = "rbxassetid://445366433",
        Duration = 5
    })
end

-- ÙˆØ§Ø¬Ù‡Ø© Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…ÙØªØ§Ø­
local KeyGui = Instance.new("ScreenGui", game.CoreGui)
KeyGui.Name = "WallhanKeyGui"

local KeyFrame = Instance.new("Frame", KeyGui)
KeyFrame.Size = UDim2.new(0, 320, 0, 180)
KeyFrame.Position = UDim2.new(0.5, -160, 0.5, -90)
KeyFrame.BackgroundColor3 = Color3.fromRGB(5, 5, 5)
KeyFrame.BackgroundTransparency = 0.05
KeyFrame.Active = true
KeyFrame.Draggable = true

local keyCorner = Instance.new("UICorner", KeyFrame)
keyCorner.CornerRadius = UDim.new(0, 10)

local keyStroke = Instance.new("UIStroke", KeyFrame)
keyStroke.Color = Color3.fromRGB(200, 0, 0)
keyStroke.Thickness = 3

-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
local KeyTitle = Instance.new("TextLabel", KeyFrame)
KeyTitle.Size = UDim2.new(1, 0, 0, 50)
KeyTitle.Position = UDim2.new(0, 0, 0, 0)
KeyTitle.Text = "ğŸ” WALLHAN HUB ACCESS ğŸ”"
KeyTitle.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
KeyTitle.TextColor3 = Color3.new(1, 1, 1)
KeyTitle.Font = Enum.Font.GothamBold
KeyTitle.TextSize = 16
Instance.new("UICorner", KeyTitle)

-- Ø­Ù‚Ù„ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…ÙØªØ§Ø­
local KeyInput = Instance.new("TextBox", KeyFrame)
KeyInput.Size = UDim2.new(0.8, 0, 0, 40)
KeyInput.Position = UDim2.new(0.1, 0, 0.3, 0)
KeyInput.PlaceholderText = "Enter Access Key..."
KeyInput.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
KeyInput.TextColor3 = Color3.new(1, 1, 1)
KeyInput.BackgroundColor3 = Color3.fromRGB(30, 0, 0)
KeyInput.ClearTextOnFocus = false
KeyInput.Font = Enum.Font.Gotham
KeyInput.TextSize = 14
Instance.new("UICorner", KeyInput)

local inputStroke = Instance.new("UIStroke", KeyInput)
inputStroke.Color = Color3.fromRGB(100, 0, 0)

-- Ø²Ø± Ø§Ù„ØªÙØ¹ÙŠÙ„
local Submit = Instance.new("TextButton", KeyFrame)
Submit.Size = UDim2.new(0.8, 0, 0, 45)
Submit.Position = UDim2.new(0.1, 0, 0.65, 0)
Submit.Text = "ğŸ”“ ACTIVATE HUB"
Submit.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
Submit.TextColor3 = Color3.new(1, 1, 1)
Submit.Font = Enum.Font.GothamBold
Submit.TextSize = 15
Instance.new("UICorner", Submit)

Submit.MouseButton1Click:Connect(function()
    local enteredKey = KeyInput.Text
    
    if enteredKey == MASTER_KEY or VALID_KEYS[enteredKey] then
        -- ØªØ£Ø«ÙŠØ± Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
        game:GetService("TweenService"):Create(
            Submit,
            TweenInfo.new(0.3),
            {BackgroundColor3 = Color3.fromRGB(0, 150, 0)}
        ):Play()
        
        Submit.Text = "âœ… ACCESS GRANTED!"
        
        task.wait(0.5)
        KeyGui:Destroy()
        StartWallhan()
    else
        -- ØªØ£Ø«ÙŠØ± ÙØ´Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
        local originalColor = Submit.BackgroundColor3
        game:GetService("TweenService"):Create(
            Submit,
            TweenInfo.new(0.2),
            {BackgroundColor3 = Color3.fromRGB(255, 0, 0)}
        ):Play()
        
        Submit.Text = "âŒ INVALID KEY!"
        
        task.wait(0.5)
        game:GetService("TweenService"):Create(
            Submit,
            TweenInfo.new(0.2),
            {BackgroundColor3 = originalColor}
        ):Play()
        
        Submit.Text = "ğŸ”“ ACTIVATE HUB"
        
        KeyInput.Text = ""
        KeyInput.PlaceholderText = "Wrong key! Try again..."
    end
end)

-- ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
KeyInput.Focused:Connect(function()
    game:GetService("TweenService"):Create(
        KeyInput.UIStroke,
        TweenInfo.new(0.2),
        {Color = Color3.fromRGB(200, 0, 0)}
    ):Play()
end)

KeyInput.FocusLost:Connect(function()
    game:GetService("TweenService"):Create(
        KeyInput.UIStroke,
        TweenInfo.new(0.2),
        {Color = Color3.fromRGB(100, 0, 0)}
    ):Play()
end)

-- Ù†Øµ ØªÙ„Ù…ÙŠØ­
local Hint = Instance.new("TextLabel", KeyFrame)
Hint.Size = UDim2.new(1, 0, 0, 20)
Hint.Position = UDim2.new(0, 0, 1, -25)
Hint.Text = "Enter 'daddy' or a valid key"
Hint.TextColor3 = Color3.fromRGB(150, 150, 150)
Hint.BackgroundTransparency = 1
Hint.Font = Enum.Font.Gotham
Hint.TextSize = 11
Hint.TextTransparency = 0.5
