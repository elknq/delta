Local MASTER_KEY = "daddy" 
local VALID_KEYS = {
    ["0x1xxxxjwj"] = true,
    ["iloveyoudaddywallhan"] = true
}

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- [[ KEY SYSTEM UI ]]
local KeyGui = Instance.new("ScreenGui", game.CoreGui)
local KeyFrame = Instance.new("Frame", KeyGui)
KeyFrame.Size = UDim2.new(0, 300, 0, 160)
KeyFrame.Position = UDim2.new(0.5, -150, 0.5, -80)
KeyFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
KeyFrame.BorderSizePixel = 0
KeyFrame.Active = true
KeyFrame.Draggable = true
Instance.new("UICorner", KeyFrame)

local KeyInput = Instance.new("TextBox", KeyFrame)
KeyInput.Size = UDim2.new(0.8, 0, 0, 35)
KeyInput.Position = UDim2.new(0.1, 0, 0.35, 0)
KeyInput.PlaceholderText = "Enter Key..."
KeyInput.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
KeyInput.TextColor3 = Color3.new(1, 1, 1)
KeyInput.BorderSizePixel = 0
KeyInput.Font = Enum.Font.Gotham
Instance.new("UICorner", KeyInput)

local Submit = Instance.new("TextButton", KeyFrame)
Submit.Size = UDim2.new(0.8, 0, 0, 35)
Submit.Position = UDim2.new(0.1, 0, 0.65, 0)
Submit.Text = "ACTIVATE"
Submit.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
Submit.TextColor3 = Color3.new(1, 1, 1)
Submit.BorderSizePixel = 0
Submit.Font = Enum.Font.GothamBold
Instance.new("UICorner", Submit)

-- [[ MAIN SCRIPT ]]
local function StartScript()
    KeyGui:Destroy()
    
    local _G_States = { ESP = false, Noclip = false, WoodShield = false }
    local targetName = ""
    local FlingActive = false
    local WoodTargetList = {}

    -- Main GUI
    local sg = Instance.new("ScreenGui", game.CoreGui)
    local Main = Instance.new("Frame", sg)
    Main.Size = UDim2.new(0, 280, 0, 480)
    Main.Position = UDim2.new(0.5, -140, 0.5, -240)
    Main.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    Main.BorderSizePixel = 0
    Main.Active = true
    Main.Draggable = true
    Instance.new("UICorner", Main)

    -- Header
    local Header = Instance.new("Frame", Main)
    Header.Size = UDim2.new(1, 0, 0, 45)
    Header.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    Header.BorderSizePixel = 0
    Instance.new("UICorner", Header)

    local Title = Instance.new("TextLabel", Header)
    Title.Size = UDim2.new(1, -50, 1, 0)
    Title.Position = UDim2.new(0, 10, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "Wallhan V2"
    Title.TextColor3 = Color3.new(1, 1, 1)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 18
    Title.TextXAlignment = Enum.TextXAlignment.Left

    local CloseBtn = Instance.new("TextButton", Header)
    CloseBtn.Size = UDim2.new(0, 35, 0, 35)
    CloseBtn.Position = UDim2.new(1, -40, 0, 5)
    CloseBtn.Text = "X"
    CloseBtn.TextColor3 = Color3.new(1, 1, 1)
    CloseBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    CloseBtn.BorderSizePixel = 0
    CloseBtn.Font = Enum.Font.GothamBold
    CloseBtn.TextSize = 16
    Instance.new("UICorner", CloseBtn)
    CloseBtn.MouseButton1Click:Connect(function() Main.Visible = false end)

    -- Scroll Frame
    local Scroll = Instance.new("ScrollingFrame", Main)
    Scroll.Size = UDim2.new(1, -20, 1, -60)
    Scroll.Position = UDim2.new(0, 10, 0, 50)
    Scroll.BackgroundTransparency = 1
    Scroll.BorderSizePixel = 0
    Scroll.ScrollBarThickness = 4
    Scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
    
    local Layout = Instance.new("UIListLayout", Scroll)
    Layout.Padding = UDim.new(0, 8)
    Layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    
    Layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        Scroll.CanvasSize = UDim2.new(0, 0, 0, Layout.AbsoluteContentSize.Y + 10)
    end)

    -- Functions
    local function CreateButton(txt, color, callback)
        local btn = Instance.new("TextButton", Scroll)
        btn.Size = UDim2.new(1, -10, 0, 38)
        btn.BackgroundColor3 = color
        btn.BorderSizePixel = 0
        btn.Text = txt
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = Enum.Font.Gotham
        btn.TextSize = 14
        Instance.new("UICorner", btn)
        btn.MouseButton1Click:Connect(callback)
        return btn
    end

    local function CreateToggle(txt, stateKey)
        local btn = Instance.new("TextButton", Scroll)
        btn.Size = UDim2.new(1, -10, 0, 38)
        btn.BorderSizePixel = 0
        btn.Font = Enum.Font.Gotham
        btn.TextSize = 14
        btn.TextColor3 = Color3.new(1, 1, 1)
        Instance.new("UICorner", btn)
        
        local function Update()
            btn.Text = txt .. (_G_States[stateKey] and " [ON]" or " [OFF]")
            btn.BackgroundColor3 = _G_States[stateKey] and Color3.fromRGB(60, 180, 75) or Color3.fromRGB(50, 50, 50)
        end
        
        btn.MouseButton1Click:Connect(function()
            _G_States[stateKey] = not _G_States[stateKey]
            Update()
        end)
        
        Update()
        return btn
    end

    local function CreateInput(placeholder)
        local input = Instance.new("TextBox", Scroll)
        input.Size = UDim2.new(1, -10, 0, 38)
        input.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        input.BorderSizePixel = 0
        input.PlaceholderText = placeholder
        input.Text = ""
        input.TextColor3 = Color3.new(1, 1, 1)
        input.Font = Enum.Font.Gotham
        input.TextSize = 13
        Instance.new("UICorner", input)
        return input
    end

    local function CreateLabel(txt)
        local lbl = Instance.new("TextLabel", Scroll)
        lbl.Size = UDim2.new(1, -10, 0, 30)
        lbl.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        lbl.BorderSizePixel = 0
        lbl.Text = txt
        lbl.TextColor3 = Color3.fromRGB(200, 200, 200)
        lbl.Font = Enum.Font.GothamBold
        lbl.TextSize = 13
        Instance.new("UICorner", lbl)
        return lbl
    end

    -- UI Elements
    CreateLabel("═══ FLING TARGET ═══")
    local flingInput = CreateInput("Fling Target Username")
    flingInput.Changed:Connect(function() targetName = flingInput.Text end)

    CreateButton("GHOST FLING", Color3.fromRGB(70, 130, 180), function()
        FlingActive = true
        task.spawn(function()
            local r = 0
            while FlingActive and LocalPlayer.Character do
                r = r + 2.5
                for _, p in pairs(Players:GetPlayers()) do
                    if p.Name:lower():find(targetName:lower()) and p.Character then
                        local hrp = LocalPlayer.Character.HumanoidRootPart
                        hrp.CFrame = p.Character.HumanoidRootPart.CFrame * CFrame.Angles(0, math.rad(r*180), 0) * CFrame.new(0,0,0.1)
                        hrp.Velocity = Vector3.new(9e6, 9e6, 9e6)
                        for _, v in pairs(LocalPlayer.Character:GetDescendants()) do 
                            if v:IsA("BasePart") then v.CanCollide = false end 
                        end
                    end
                end
                RunService.Heartbeat:Wait()
            end
        end)
    end)

    CreateButton("STOP FLING", Color3.fromRGB(180, 60, 60), function()
        FlingActive = false
    end)

    CreateLabel("═══ WOOD TARGET LIST ═══")
    local woodInput = CreateInput("Wood Target Username")

    CreateButton("ADD TO LIST", Color3.fromRGB(60, 180, 75), function()
        if woodInput.Text ~= "" then
            table.insert(WoodTargetList, woodInput.Text:lower())
            woodInput.Text = ""
        end
    end)

    CreateButton("CLEAR LIST", Color3.fromRGB(180, 60, 60), function()
        WoodTargetList = {}
    end)

    CreateToggle("WOOD SHIELD", "WoodShield")

    CreateLabel("═══ OTHER FEATURES ═══")
    CreateToggle("ESP", "ESP")
    CreateToggle("NOCLIP", "Noclip")

    CreateButton("GIVE TP TOOL", Color3.fromRGB(100, 100, 100), function()
        local tp = Instance.new("Tool", LocalPlayer.Backpack)
        tp.Name = "TP Tool"
        tp.RequiresHandle = false
        tp.Activated:Connect(function()
            LocalPlayer.Character:MoveTo(Mouse.Hit.p)
        end)
    end)

    -- Toggle Button
    local ToggleBtn = Instance.new("TextButton", sg)
    ToggleBtn.Size = UDim2.new(0, 50, 0, 50)
    ToggleBtn.Position = UDim2.new(0, 20, 0, 20)
    ToggleBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    ToggleBtn.BorderSizePixel = 0
    ToggleBtn.Text = "W"
    ToggleBtn.TextColor3 = Color3.new(1, 1, 1)
    ToggleBtn.Font = Enum.Font.GothamBold
    ToggleBtn.TextSize = 20
    ToggleBtn.Active = true
    ToggleBtn.Draggable = true
    Instance.new("UICorner", ToggleBtn).CornerRadius = UDim.new(0.5, 0)
    ToggleBtn.MouseButton1Click:Connect(function()
        Main.Visible = not Main.Visible
    end)

    -- Wood Shield Logic
    task.spawn(function()
        local angle = 0
        while true do
            if _G_States.WoodShield and LocalPlayer.Character then
                angle = angle + 4
                local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                if hrp then
                    for _, v in pairs(workspace:GetDescendants()) do
                        if v:IsA("BasePart") and not v.Anchored and not v:IsDescendantOf(LocalPlayer.Character) then
                            if v.Name:lower():find("wood") or v.Name:lower():find("door") or v.Material == Enum.Material.Wood then
                                for _, m in pairs(v:GetChildren()) do
                                    if m:IsA("BodyMover") or m:IsA("AlignPosition") or m:IsA("Attachment") then 
                                        m:Destroy() 
                                    end
                                end
                                
                                local targetHRP = hrp
                                
                                if #WoodTargetList > 0 then
                                    for _, p in pairs(Players:GetPlayers()) do
                                        for _, targetUsername in pairs(WoodTargetList) do
                                            if p.Name:lower():find(targetUsername) and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                                                targetHRP = p.Character.HumanoidRootPart
                                                break
                                            end
                                        end
                                    end
                                end
                                
                                local a0, a1 = Instance.new("Attachment", v), Instance.new("Attachment", targetHRP)
                                local al = Instance.new("AlignPosition", v)
                                al.Attachment0, al.Attachment1 = a0, a1
                                al.MaxForce, al.MaxVelocity, al.Responsiveness = math.huge, math.huge, 500
                                a1.Position = Vector3.new(math.cos(angle)*1.2, 0, math.sin(angle)*1.2)
                                v.Velocity = Vector3.new(1000, 1000, 1000)
                                v.CanCollide = false
                                game:GetService("Debris"):AddItem(a1, 0.1)
                            end
                        end
                    end
                end
            end
            RunService.Heartbeat:Wait()
        end
    end)

    -- Noclip
    RunService.Stepped:Connect(function()
        if _G_States.Noclip and LocalPlayer.Character then
            for _, v in pairs(LocalPlayer.Character:GetDescendants()) do
                if v:IsA("BasePart") then v.CanCollide = false end
            end
        end
    end)

    -- ESP
    RunService.RenderStepped:Connect(function()
        if _G_States.ESP then
            for _, p in pairs(Players:GetPlayers()) do
                if p ~= LocalPlayer and p.Character then
                    local h = p.Character:FindFirstChild("ZE") or Instance.new("Highlight", p.Character)
                    h.Name = "ZE"
                    h.FillColor = Color3.new(1, 0, 0)
                    h.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                end
            end
        end
    end)
end

-- Key Check
Submit.MouseButton1Click:Connect(function()
    if KeyInput.Text == MASTER_KEY or VALID_KEYS[KeyInput.Text] then
        StartScript()
    else
        Submit.Text = "WRONG KEY"
        task.wait(1)
        Submit.Text = "ACTIVATE"
    end
end)
