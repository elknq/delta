--[[
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘       WALLHAN HUB - PROFESSIONAL V3      â•‘
    â•‘  FE Emote, Advanced Wood Shield, New UI  â•‘
    â•‘  âœ… FINAL FIX: Loadstring/Delta Compatibility â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
]]

local MASTER_KEY = "daddy" 
local VALID_KEYS = {["0x1xxxxjwj"] = true, ["iloveyoudaddywallhan"] = true}

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

-- âœ… FIX: Ø³ÙŠØªÙ… ØªØ¹Ø±ÙŠÙ LocalPlayer Ùˆ Mouse Ù„Ø§Ø­Ù‚Ø§Ù‹ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Loadstring
local LocalPlayer
local Mouse

-- Ù…ØªØºÙŠØ± Ù„Ø­ÙØ¸ Ù†Ù‚Ø·Ø© Ø§Ù„ØªØ´ÙŠÙƒ Ø¨ÙˆÙŠÙ†Øª
local SavedCheckpoint = nil

-- [[ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ø®Ø·ÙˆØ· ]]
local PRIMARY_COLOR = Color3.fromRGB(255, 50, 50) -- Ø£Ø­Ù…Ø± Ù†Ø§Ø±ÙŠ
local SECONDARY_COLOR = Color3.fromRGB(30, 30, 30) -- Ø®Ù„ÙÙŠØ© Ø¯Ø§ÙƒÙ†Ø©
local ACCENT_COLOR = Color3.fromRGB(0, 200, 50) -- Ø£Ø®Ø¶Ø± Ù„Ù„ØªØ´ØºÙŠÙ„
local FONT = Enum.Font.GothamBold

-- Ø¯Ø§Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ ØªØ£Ø«ÙŠØ±Ø§Øª Ø­Ø±ÙƒÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
local function AnimateButton(button)
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.15), {BackgroundColor3 = PRIMARY_COLOR}):Play()
    end)
    button.MouseLeave:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.15), {BackgroundColor3 = button:GetAttribute("OriginalColor") or SECONDARY_COLOR}):Play()
    end)
end

-- [[ Ø¯Ø§Ù„Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø±Ù‚ØµØ§Øª - Beautiful Dance (FE) ]]
local function PlayFEEmote(animationId)
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        local anim = Instance.new("Animation")
        anim.AnimationId = "rbxassetid://" .. animationId
        local load = LocalPlayer.Character.Humanoid:LoadAnimation(anim)
        load.Priority = Enum.AnimationPriority.Action -- Ù„Ø²ÙŠØ§Ø¯Ø© ÙØ±ØµØ© Ø±Ø¤ÙŠØ© Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† Ù„Ù‡Ø§
        load:Play()
        
        -- Ø¥Ø´Ø¹Ø§Ø±
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "âœ¨ Wallhan Emotes",
            Text = "ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø±Ù‚ØµØ© (FE)!",
            Duration = 3
        })
    end
end

-- [[ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚ØµØ§Øª ]]
local function OpenWallhanEmotes()
    local parentGui = game.CoreGui
    if LocalPlayer and LocalPlayer:FindFirstChild("PlayerGui") then
        parentGui = LocalPlayer.PlayerGui
    end
    
    local existingGui = parentGui:FindFirstChild("WallhanEmotesMenu")
    if existingGui then existingGui:Destroy() end
    
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "WallhanEmotesMenu"
    ScreenGui.DisplayOrder = 999
    ScreenGui.Parent = parentGui
    
    local MainFrame = Instance.new("Frame", ScreenGui)
    MainFrame.Size = UDim2.new(0, 350, 0, 250)
    MainFrame.Position = UDim2.new(0.5, -175, 0.5, -125)
    MainFrame.BackgroundColor3 = SECONDARY_COLOR
    MainFrame.Active = true
    MainFrame.Draggable = true
    
    local corner = Instance.new("UICorner", MainFrame)
    corner.CornerRadius = UDim.new(0, 12)
    
    local stroke = Instance.new("UIStroke", MainFrame)
    stroke.Color = PRIMARY_COLOR
    stroke.Thickness = 3
    stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    
    local Title = Instance.new("TextLabel", MainFrame)
    Title.Size = UDim2.new(1, 0, 0, 55)
    Title.Text = "ğŸ’ƒ BEAUTIFUL DANCE (FE) ğŸ’ƒ"
    Title.BackgroundColor3 = PRIMARY_COLOR
    Title.TextColor3 = Color3.new(1, 1, 1)
    Title.Font = FONT
    Title.TextSize = 20
    
    local DanceButton = Instance.new("TextButton", MainFrame)
    DanceButton.Size = UDim2.new(0.85, 0, 0, 65)
    DanceButton.Position = UDim2.new(0.075, 0, 0.48, 0)
    DanceButton.Text = "â–¶ï¸ PLAY BEAUTIFUL DANCE"
    DanceButton.BackgroundColor3 = Color3.fromRGB(60, 10, 10)
    DanceButton.TextColor3 = Color3.new(1, 1, 1)
    DanceButton.Font = FONT
    DanceButton.TextSize = 18
    
    local btnCorner = Instance.new("UICorner", DanceButton)
    btnCorner.CornerRadius = UDim.new(0, 10)
    
    DanceButton:SetAttribute("OriginalColor", Color3.fromRGB(60, 10, 10))
    AnimateButton(DanceButton)
    
    DanceButton.MouseButton1Click:Connect(function()
        PlayFEEmote("4077918384157") -- Beautiful Dance ID
    end)

    local Close = Instance.new("TextButton", MainFrame)
    Close.Size = UDim2.new(0, 35, 0, 35)
    Close.Position = UDim2.new(1, -42, 0, 7)
    Close.Text = "âœ•"
    Close.BackgroundColor3 = PRIMARY_COLOR
    Close.TextColor3 = Color3.new(1, 1, 1)
    Close.Font = FONT
    Close.TextSize = 18
    
    local closeCorner = Instance.new("UICorner", Close)
    closeCorner.CornerRadius = UDim.new(0, 8)
    
    Close:SetAttribute("OriginalColor", PRIMARY_COLOR)
    AnimateButton(Close)
    
    Close.MouseButton1Click:Connect(function() 
        ScreenGui:Destroy() 
    end)
end

-- [[ START CORE ]]
local function StartWallhan()
    local _G_States = { ESP = false, Noclip = false, WoodShield = false, AntiFling = false }
    
    -- âœ… FIX: Ø§Ø³ØªØ®Ø¯Ø§Ù… LocalPlayer Ùˆ Mouse Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„Ù‡Ù…Ø§
    LocalPlayer = Players.LocalPlayer
    Mouse = LocalPlayer:GetMouse()
    
    local parentGui = game.CoreGui
    if LocalPlayer and LocalPlayer:FindFirstChild("PlayerGui") then
        parentGui = LocalPlayer.PlayerGui
    end
    
    local sg = Instance.new("ScreenGui")
    sg.Name = "WallhanHub"
    sg.ResetOnSpawn = false
    sg.Parent = parentGui
    
    local Main = Instance.new("Frame", sg)
    Main.Size = UDim2.new(0, 320, 0, 620)
    Main.Position = UDim2.new(1, -340, 0.5, -310)
    Main.BackgroundColor3 = SECONDARY_COLOR
    Main.Active = true
    Main.Draggable = true
    Main.ClipsDescendants = true
    
    local mainCorner = Instance.new("UICorner", Main)
    mainCorner.CornerRadius = UDim.new(0, 15)
    
    local mainStroke = Instance.new("UIStroke", Main)
    mainStroke.Color = PRIMARY_COLOR
    mainStroke.Thickness = 3
    
    -- Header Ø§Ø­ØªØ±Ø§ÙÙŠ
    local Header = Instance.new("Frame", Main)
    Header.Size = UDim2.new(1, 0, 0, 60)
    Header.BackgroundColor3 = PRIMARY_COLOR
    
    local Logo = Instance.new("TextLabel", Header)
    Logo.Size = UDim2.new(1, 0, 0.6, 0)
    Logo.Position = UDim2.new(0, 0, 0.1, 0)
    Logo.Text = "âš¡ WALLHAN HUB âš¡"
    Logo.BackgroundTransparency = 1
    Logo.TextColor3 = Color3.new(1, 1, 1)
    Logo.Font = FONT
    Logo.TextSize = 22
    
    local Subtitle = Instance.new("TextLabel", Header)
    Subtitle.Size = UDim2.new(1, 0, 0.3, 0)
    Subtitle.Position = UDim2.new(0, 0, 0.65, 0)
    Subtitle.Text = "Professional Edition V3"
    Subtitle.BackgroundTransparency = 1
    Subtitle.TextColor3 = Color3.fromRGB(255, 200, 200)
    Subtitle.Font = Enum.Font.Gotham
    Subtitle.TextSize = 12

    -- Scrolling Frame Ù„Ù„Ø£Ø²Ø±Ø§Ø±
    local List = Instance.new("ScrollingFrame", Main)
    List.Size = UDim2.new(1, -20, 1, -80)
    List.Position = UDim2.new(0, 10, 0, 70)
    List.BackgroundTransparency = 1
    List.BorderSizePixel = 0
    List.ScrollBarThickness = 6
    List.ScrollBarImageColor3 = PRIMARY_COLOR
    List.CanvasSize = UDim2.new(0, 0, 3.5, 0)
    
    local listLayout = Instance.new("UIListLayout", List)
    listLayout.Padding = UDim.new(0, 10)
    listLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    -- Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø²Ø±Ø§Ø± Ø§Ø­ØªØ±Ø§ÙÙŠØ©
    local function CreateButton(txt, icon, cb)
        local b = Instance.new("TextButton", List)
        b.Size = UDim2.new(0.95, 0, 0, 50)
        b.BackgroundColor3 = Color3.fromRGB(40, 5, 5)
        b.Text = icon .. "  " .. txt
        b.TextColor3 = Color3.new(1, 1, 1)
        b.Font = FONT
        b.TextSize = 15
        b.TextXAlignment = Enum.TextXAlignment.Left
        b.TextXOffset = 15
        
        local btnCorner = Instance.new("UICorner", b)
        btnCorner.CornerRadius = UDim.new(0, 10)
        
        local btnStroke = Instance.new("UIStroke", b)
        btnStroke.Color = Color3.fromRGB(100, 20, 20)
        btnStroke.Thickness = 2
        
        b:SetAttribute("OriginalColor", Color3.fromRGB(40, 5, 5))
        AnimateButton(b)
        b.MouseButton1Click:Connect(cb)
    end

    -- Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ Toggle Ø§Ø­ØªØ±Ø§ÙÙŠ
    local function CreateToggle(txt, icon, stateKey)
        local b = Instance.new("TextButton", List)
        b.Size = UDim2.new(0.95, 0, 0, 50)
        b.Font = FONT
        b.TextSize = 15
        b.TextXAlignment = Enum.TextXAlignment.Left
        b.TextXOffset = 15
        
        local btnCorner = Instance.new("UICorner", b)
        btnCorner.CornerRadius = UDim.new(0, 10)
        
        local btnStroke = Instance.new("UIStroke", b)
        btnStroke.Thickness = 2
        
        local indicator = Instance.new("Frame", b)
        indicator.Size = UDim2.new(0, 40, 0, 24)
        indicator.Position = UDim2.new(1, -50, 0.5, -12)
        indicator.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
        
        local indCorner = Instance.new("UICorner", indicator)
        indCorner.CornerRadius = UDim.new(1, 0)
        
        local circle = Instance.new("Frame", indicator)
        circle.Size = UDim2.new(0, 20, 0, 20)
        circle.Position = UDim2.new(0, 2, 0.5, -10)
        circle.BackgroundColor3 = Color3.new(1, 1, 1)
        
        local circleCorner = Instance.new("UICorner", circle)
        circleCorner.CornerRadius = UDim.new(1, 0)
        
        local function Upd()
            b.Text = icon .. "  " .. txt
            if _G_States[stateKey] then
                b.BackgroundColor3 = Color3.fromRGB(60, 10, 10)
                b.TextColor3 = Color3.new(1, 1, 1)
                btnStroke.Color = ACCENT_COLOR
                TweenService:Create(indicator, TweenInfo.new(0.2), {BackgroundColor3 = ACCENT_COLOR}):Play()
                TweenService:Create(circle, TweenInfo.new(0.2), {Position = UDim2.new(1, -22, 0.5, -10)}):Play()
            else
                b.BackgroundColor3 = Color3.fromRGB(30, 5, 5)
                b.TextColor3 = Color3.fromRGB(200, 200, 200)
                btnStroke.Color = Color3.fromRGB(100, 20, 20)
                TweenService:Create(indicator, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 100, 100)}):Play()
                TweenService:Create(circle, TweenInfo.new(0.2), {Position = UDim2.new(0, 2, 0.5, -10)}):Play()
            end
        end
        
        b.MouseButton1Click:Connect(function() 
            _G_States[stateKey] = not _G_States[stateKey] 
            Upd() 
        end)
        Upd()
    end

    -- [ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„ÙˆØ¸Ø§Ø¦Ù ]
    CreateButton("SET CHECKPOINT", "ğŸš©", function()
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            SavedCheckpoint = LocalPlayer.Character.HumanoidRootPart.CFrame
            game:GetService("StarterGui"):SetCore("SendNotification", {Title = "âœ… Wallhan Hub", Text = "ØªÙ… Ø­ÙØ¸ Ù†Ù‚Ø·Ø© Ø§Ù„ØªÙØªÙŠØ´!", Duration = 3})
        end
    end)

    CreateButton("TP TO CHECKPOINT", "ğŸŒ€", function()
        if SavedCheckpoint and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            LocalPlayer.Character.HumanoidRootPart.CFrame = SavedCheckpoint
            game:GetService("StarterGui"):SetCore("SendNotification", {Title = "âœ… Wallhan Hub", Text = "ØªÙ… Ø§Ù„Ù†Ù‚Ù„ Ø¥Ù„Ù‰ Ù†Ù‚Ø·Ø© Ø§Ù„ØªÙØªÙŠØ´!", Duration = 2})
        else
            game:GetService("StarterGui"):SetCore("SendNotification", {Title = "âŒ Wallhan Hub", Text = "Ù„Ù… ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† Ù†Ù‚Ø·Ø© ØªÙØªÙŠØ´!", Duration = 3})
        end
    end)

    CreateButton("RANDOM PLAYER TP", "ğŸ²", function()
        local plrs = Players:GetPlayers()
        if #plrs > 1 then
            local rP = plrs[math.random(1, #plrs)]
            if rP and rP ~= LocalPlayer and rP.Character and rP.Character:FindFirstChild("HumanoidRootPart") then
                LocalPlayer.Character:SetPrimaryPartCFrame(rP.Character.HumanoidRootPart.CFrame + Vector3.new(0, 5, 0))
                game:GetService("StarterGui"):SetCore("SendNotification", {Title = "âœ… Wallhan Hub", Text = "ØªÙ… Ø§Ù„Ù†Ù‚Ù„ Ø¥Ù„Ù‰: " .. rP.Name, Duration = 2})
            end
        end
    end)

    CreateButton("WALLHAN EMOTES", "ğŸ’ƒ", function()
        OpenWallhanEmotes()
    end)

    CreateButton("TELEPORT TOOL", "ğŸ“", function()
        local tp = Instance.new("Tool", LocalPlayer.Backpack)
        tp.Name = "Wallhan TP ğŸ“"
        tp.RequiresHandle = false
        tp.Activated:Connect(function() 
            if LocalPlayer.Character then
                LocalPlayer.Character:MoveTo(Mouse.Hit.p) 
            end
        end)
        game:GetService("StarterGui"):SetCore("SendNotification", {Title = "âœ… Wallhan Hub", Text = "ØªÙ… Ø¥Ø¹Ø·Ø§Ø¡ Ø£Ø¯Ø§Ø© Ø§Ù„Ù†Ù‚Ù„!", Duration = 2})
    end)
    
    CreateToggle("ANTI-FLING", "ğŸ›¡ï¸", "AntiFling")
    CreateToggle("WOOD SHIELD", "ğŸŒªï¸", "WoodShield")
    CreateToggle("BOX ESP + NAMES", "ğŸ‘ï¸", "ESP")
    CreateToggle("NOCLIP", "ğŸ§±", "Noclip")

    -- [[ Wood Shield - Ù…Ø­Ø³Ù‘Ù† (ÙŠØ¨Ù‚Ù‰ Ù„Ø£Ø·ÙˆÙ„ Ù…Ø¯Ø©ØŒ Ø¯ÙˆØ±Ø§Ù† Ø¹Ø´ÙˆØ§Ø¦ÙŠØŒ ÙŠÙ‚Ø°Ù Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†) ]]
    task.spawn(function()
        local angle = 0
        local woodParts = {} -- Ù„Ø­ÙØ¸ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„ØªÙŠ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§
        
        while true do
            if _G_States.WoodShield and LocalPlayer.Character then
                angle = angle + 4
                local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                if hrp then
                    
                    -- 1. Ø¬Ù…Ø¹ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙˆØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù‚ÙˆØ© Ø¹Ù„ÙŠÙ‡Ø§
                    for _, v in pairs(workspace:GetDescendants()) do
                        if v:IsA("BasePart") and not v.Anchored and not v:IsDescendantOf(LocalPlayer.Character) and not v.Parent:FindFirstChild("Humanoid") and not v.Parent:IsA("Accessory") then
                            if v.Name:lower():find("wood") or v.Name:lower():find("door") or v.Material == Enum.Material.Wood then
                                
                                -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ AlignPosition Ù…Ø³Ø¨Ù‚Ø§Ù‹
                                if not v:FindFirstChild("WallhanAlign") then
                                    
                                    -- ØªÙ†Ø¸ÙŠÙ Ø£ÙŠ BodyMovers Ù‚Ø¯ÙŠÙ…Ø©
                                    for _, m in pairs(v:GetChildren()) do
                                        if m:IsA("BodyMover") or m:IsA("AlignPosition") or m:IsA("Attachment") then m:Destroy() end
                                    end
                                    
                                    local a0 = Instance.new("Attachment", v)
                                    local a1 = Instance.new("Attachment", hrp)
                                    local al = Instance.new("AlignPosition", v)
                                    al.Name = "WallhanAlign"
                                    al.Attachment0 = a0
                                    al.Attachment1 = a1
                                    al.MaxForce = math.huge
                                    al.MaxVelocity = math.huge
                                    al.Responsiveness = 500
                                    
                                    -- âœ… Ø§Ù„Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠ (ÙŠÙ…ÙŠÙ†ØŒ ÙŠØ³Ø§Ø±ØŒ ÙÙˆÙ‚ØŒ ØªØ­Øª)
                                    local radius = 3 -- Ù†ØµÙ Ù‚Ø·Ø± Ø§Ù„Ø¯ÙˆØ±Ø§Ù†
                                    local y_offset = math.sin(math.rad(angle * 2)) * 1.5 -- Ø­Ø±ÙƒØ© Ø¹Ù…ÙˆØ¯ÙŠØ©
                                    a1.Position = Vector3.new(
                                        math.cos(math.rad(angle)) * radius, 
                                        y_offset, 
                                        math.sin(math.rad(angle)) * radius
                                    )
                                    
                                    v.CanCollide = false -- Ù„Ø§ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù†ÙØ³Ù‡
                                    
                                    -- âœ… ÙŠØ¨Ù‚Ù‰ Ù„Ø£Ø·ÙˆÙ„ Ù…Ø¯Ø©: Ù„Ø§ Ù†Ø³ØªØ®Ø¯Ù… Debris:AddItem
                                    table.insert(woodParts, {part = v, align = al, att = a1})
                                    
                                    -- âœ… ÙŠÙ‚Ø°Ù Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†: Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ù„Ø© Touch
                                    v.Touched:Connect(function(hit)
                                        local hitHumanoid = hit.Parent:FindFirstChildOfClass("Humanoid")
                                        if hitHumanoid and hitHumanoid.Parent ~= LocalPlayer.Character then
                                            local targetHRP = hitHumanoid.Parent:FindFirstChild("HumanoidRootPart")
                                            if targetHRP then
                                                local direction = (targetHRP.Position - hrp.Position).Unit
                            
(Content truncated due to size limit. Use page ranges or line ranges to read remaining content)
